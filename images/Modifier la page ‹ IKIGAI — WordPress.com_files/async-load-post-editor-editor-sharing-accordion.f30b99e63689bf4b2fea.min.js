(window.webpackJsonp=window.webpackJsonp||[]).push([[78],{"./client/components/data/query-keyring-connections/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),a=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(a),l=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(l),d=n("./node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(d),h=n("./node_modules/prop-types/index.js"),b=n.n(h),m=n("./node_modules/react/index.js"),g=n("./node_modules/react-redux/es/index.js"),f=n("./client/state/sharing/keyring/selectors.js"),j=n("./client/state/sharing/keyring/actions.js"),_=function(e){function t(){return o()(this,t),c()(this,p()(t).apply(this,arguments))}return u()(t,e),r()(t,[{key:"componentWillMount",value:function(){this.props.isRequesting||this.props.requestKeyringConnections(this.props.forceRefresh)}},{key:"render",value:function(){return null}}]),t}(m.Component);_.propTypes={forceRefresh:b.a.bool,isRequesting:b.a.bool,requestKeyringConnections:b.a.func},_.defaultProps={forceRefresh:!1},t.a=Object(g.b)(function(e){return{isRequesting:Object(f.d)(e)}},{requestKeyringConnections:j.c})(_)},"./client/components/forms/counted-textarea/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/extends.js"),o=n.n(s),i=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(i),a=n("./node_modules/@babel/runtime/helpers/createClass.js"),c=n.n(a),l=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=n.n(l),d=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),u=n.n(d),h=n("./node_modules/@babel/runtime/helpers/inherits.js"),b=n.n(h),m=n("./node_modules/react/index.js"),g=n.n(m),f=n("./node_modules/prop-types/index.js"),j=n.n(f),_=n("./node_modules/i18n-calypso/index.js"),v=n("./node_modules/classnames/index.js"),k=n.n(v),C=n("./node_modules/lodash/lodash.js"),y=n("./client/components/forms/form-textarea/index.jsx"),E=function(e){function t(){var e,n;r()(this,t);for(var s=arguments.length,o=new Array(s),i=0;i<s;i++)o[i]=arguments[i];return n=p()(this,(e=u()(t)).call.apply(e,[this].concat(o))),n.renderCountPanel=function(){var e,t=n.props.value.length;return!t&&n.props.countPlaceholderLength&&(t=n.props.placeholder.length),e=n.props.showRemainingCharacters&&n.props.acceptableLength?n.props.translate("%d character remaining","%d characters remaining",{context:"Input length",args:[n.props.acceptableLength-t],count:n.props.acceptableLength-t}):n.props.translate("%d character","%d characters",{context:"Input length",args:[t],count:t}),g.a.createElement("div",{className:"counted-textarea__count-panel"},e,n.props.children)},n}return b()(t,e),c()(t,[{key:"render",value:function(){var e=k()("counted-textarea",this.props.className,{"is-exceeding-acceptable-length":this.props.acceptableLength&&this.props.value.length>this.props.acceptableLength});return g.a.createElement("div",{className:e},g.a.createElement(y.a,o()({},Object(C.omit)(this.props,"className","acceptableLength","showRemainingCharacters","children","countPlaceholderLength","moment","numberFormat","translate"),{className:"counted-textarea__input"})),this.renderCountPanel())}}]),t}(g.a.Component);E.propTypes={value:j.a.string,placeholder:j.a.string,countPlaceholderLength:j.a.bool,onChange:j.a.func,acceptableLength:j.a.number,showRemainingCharacters:j.a.bool,translate:j.a.func},E.defaultProps={value:"",placeholder:"",countPlaceholderLength:!1,onChange:C.noop,showRemainingCharacters:!1,translate:_.translate},t.a=Object(_.localize)(E)},"./client/lib/post-metadata/index.js":function(e,t,n){"use strict";var s,o=n("./node_modules/lodash/lodash.js"),i=/^_wpas_skip_(\d+)$/,r=/^_wpas_done_(\d+)$/;function a(e,t){var n=Object(o.find)(e,{key:t});if(n)return n.value}function c(e,t){return e?e.filter(function(e){return t.test(e.key)&&1===parseInt(e.value,10)}).map(function(e){return parseInt(e.key.match(t)[1],10)}):[]}s={publicizeMessage:function(e){if(e)return a(e.metadata,"_wpas_mess")},publicizeDone:function(e){if(e)return c(e.metadata,r)},publicizeSkipped:function(e){if(e)return c(e.metadata,i)},geoLabel:function(e){if(e)return a(e.metadata,"geo_address")},metaDescription:function(e){if(e)return a(e.metadata,"advanced_seo_description")},geoCoordinates:function(e){var t,n;if(e)return t=parseFloat(a(e.metadata,"geo_latitude")),n=parseFloat(a(e.metadata,"geo_longitude")),t&&n?[t,n]:void 0},geoIsSharedPublicly:function(e){if(!e)return null;var t=a(e.metadata,"geo_public");return!!parseInt(t,10)||void 0===t&&(!a(e.metadata,"geo_latitude")&&!a(e.metadata,"geo_longitude"))}},t.a=s},"./client/post-editor/editor-fieldset/index.jsx":function(e,t,n){"use strict";n.d(t,"a",function(){return _});var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),a=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(a),l=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(l),d=n("./node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(d),h=n("./node_modules/prop-types/index.js"),b=n.n(h),m=n("./node_modules/react/index.js"),g=n.n(m),f=n("./node_modules/classnames/index.js"),j=n.n(f),_=function(e){function t(){var e,n;o()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=c()(this,(e=p()(t)).call.apply(e,[this].concat(i))),n.renderChildren=function(){return g.a.Children.map(n.props.children,function(e){return g.a.createElement("div",{className:"editor-fieldset__option"},e)})},n}return u()(t,e),r()(t,[{key:"render",value:function(){return g.a.createElement("fieldset",{className:j()("editor-fieldset",this.props.className)},g.a.createElement("legend",{className:"editor-fieldset__legend"},this.props.legend),this.renderChildren())}}]),t}(g.a.Component);_.displayName="EditorFieldset",_.propTypes={legend:b.a.oneOfType([b.a.string,b.a.element]).isRequired}},"./client/post-editor/editor-sharing/accordion.jsx":function(e,t,n){"use strict";n.r(t);var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),a=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(a),l=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(l),d=n("./node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(d),h=n("./node_modules/prop-types/index.js"),b=n.n(h),m=n("./node_modules/i18n-calypso/index.js"),g=n("./node_modules/react/index.js"),f=n.n(g),j=n("./node_modules/classnames/index.js"),_=n.n(j),v=n("./node_modules/react-redux/es/index.js"),k=n("./node_modules/lodash/lodash.js"),C=n("./client/components/accordion/index.jsx"),y=n("./client/components/forms/form-text-input/index.jsx"),E=n("./client/lib/post-metadata/index.js"),x=n("./node_modules/gridicons/dist/index.js"),O=n.n(x),P=n("./client/components/data/query-post-types/index.jsx"),S=n("./client/post-editor/editor-sharing/publicize-message.jsx"),w=n("./client/components/forms/form-checkbox/index.jsx"),z=n("./client/state/posts/stats.js"),I=n("./client/components/notice/index.jsx"),N=n("./client/components/notice/notice-action.jsx"),M=n("./client/state/ui/selectors.js"),L=n("./client/state/posts/actions.js"),B=n("./client/state/ui/editor/selectors.js"),R=n("./client/state/posts/selectors.js"),q=n("./client/state/sharing/keyring/selectors.js"),D=n("./client/components/data/query-keyring-connections/index.jsx"),F=function(e){function t(){var e,n;o()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=c()(this,(e=p()(t)).call.apply(e,[this].concat(i))),n.isConnectionSkipped=function(){var e=n.props,t=e.post,s=e.connection;return t&&s&&Object(k.includes)(E.a.publicizeSkipped(t),s.keyring_connection_ID)},n.isConnectionDone=function(){var e=n.props,t=e.post,s=e.connection;return t&&s&&Object(k.includes)(E.a.publicizeDone(t),s.keyring_connection_ID)},n.isDisabled=function(){var e=n.props.connection;return!e||e.read_only},n.onChange=function(e){var t=n.props.connection;t&&(e.target.checked?(n.props.deletePostMetadata(n.props.siteId,n.props.postId,"_wpas_skip_"+t.keyring_connection_ID),n.props.recordEditorStat("sharing_enabled_"+t.service),n.props.recordEditorEvent("Publicize Service",t.service,"enabled")):(n.props.updatePostMetadata(n.props.siteId,n.props.postId,"_wpas_skip_"+t.keyring_connection_ID,1),n.props.recordEditorStat("sharing_disabled_"+t.service),n.props.recordEditorEvent("Publicize Service",t.service,"disabled")))},n.renderFacebookProfileWarning=function(){var e=n.props,t=e.connection,s=e.isKeyringFetching;if(t&&"facebook"===t.service&&!s&&!n.isAdditionalExternalUser(t))return f.a.createElement(I.b,{isCompact:!0,className:"editor-sharing__broken-publicize-connection",status:"is-warning",showDismiss:!1},n.props.translate("Connections to Facebook profiles will cease to work on August 1st"))},n.renderBrokenConnection=function(){var e=n.props.connection;if(e&&"broken"===e.status)return f.a.createElement(I.b,{isCompact:!0,className:"editor-sharing__broken-publicize-connection",status:"is-warning",showDismiss:!1},n.props.translate("There is an issue connecting to %s.",{args:e.label}),f.a.createElement(N.a,{onClick:n.props.onRefresh},"Reconnect ",f.a.createElement(O.a,{icon:"external",size:18})))},n}return u()(t,e),r()(t,[{key:"isAdditionalExternalUser",value:function(e){var t=this.props.keyringConnection;return!!t&&t.external_ID!==e.external_ID}},{key:"render",value:function(){var e=this.props,t=e.connection,n=e.label;return f.a.createElement("div",{className:"editor-sharing__publicize-connection"},f.a.createElement(D.a,null),f.a.createElement("label",null,f.a.createElement(w.a,{checked:!this.isConnectionSkipped(),disabled:this.isDisabled(),onChange:this.onChange}),f.a.createElement("span",{"data-e2e-service":n},t&&t.external_display)),this.renderFacebookProfileWarning(),this.renderBrokenConnection())}}]),t}(f.a.Component);F.propTypes={post:b.a.object,connection:b.a.object,onRefresh:b.a.func,label:b.a.string},F.defaultProps={onRefresh:function(){}};var A=Object(v.b)(function(e,t){var n=Object(M.e)(e),s=Object(B.f)(e),o=Object(R.a)(e,n,s),i=Object(q.d)(e),r=null;return t.connection&&(r=Object(q.a)(e,t.connection.keyring_connection_ID)),{isKeyringFetching:i,keyringConnection:r,siteId:n,postId:s,post:o}},{updatePostMetadata:L.o,deletePostMetadata:L.d,recordEditorStat:z.b,recordEditorEvent:z.a})(Object(m.localize)(F)),T=n("./client/state/current-user/selectors.js"),U=n("./client/state/sharing/publicize/selectors.js"),J=function(e){var t=e.connections,n=e.newConnectionPopup;return f.a.createElement("ul",{className:"editor-sharing__publicize-services"},Object(k.map)(Object(k.groupBy)(t,"label"),function(e,t){return f.a.createElement("li",{key:t,className:"editor-sharing__publicize-service"},f.a.createElement("h5",{className:"editor-sharing__publicize-service-heading"},t),e.map(function(e){return f.a.createElement(A,{key:e.ID,connection:e,onRefresh:n,label:t})}))}))};J.propTypes={connections:b.a.array.isRequired,newConnectionPopup:b.a.func.isRequired};var H=Object(v.b)(function(e){var t=Object(M.e)(e),n=Object(T.g)(e);return{connections:Object(U.c)(e,t,n)}})(J),K=n("./client/lib/paths/index.js"),W=n("./client/lib/popup-monitor/index.js"),V=n("./client/components/button/index.jsx"),$=n("./client/state/sites/selectors.js"),G=n("./client/state/sharing/publicize/actions.js"),Q=n("./client/state/selectors/can-current-user.js"),X=n("./client/state/selectors/is-publicize-enabled.js"),Y=function(e){function t(){var e,n;o()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=c()(this,(e=p()(t)).call.apply(e,[this].concat(i))),n.connectionPopupMonitor=!1,n.hasConnections=function(){return n.props.connections&&n.props.connections.length},n.newConnectionPopup=function(){if(n.props.site){var e=Object(K.c)(n.props.site);n.connectionPopupMonitor||(n.connectionPopupMonitor=new W.a),n.connectionPopupMonitor.open(e),n.connectionPopupMonitor.once("close",n.onNewConnectionPopupClosed)}},n.onNewConnectionPopupClosed=function(){n.props.requestConnections(n.props.site.ID)},n.newConnection=function(){n.newConnectionPopup(),n.props.recordEditorStat("sharing_create_service"),n.props.recordEditorEvent("Opened Create New Sharing Service Dialog")},n.renderServices=function(){if(n.props.site&&n.hasConnections())return f.a.createElement(H,{newConnectionPopup:n.newConnectionPopup})},n.renderMessage=function(){var e=n.hasConnections()?E.a.publicizeSkipped(n.props.post):[],t=n.hasConnections()?n.props.connections.filter(function(t){return e&&-1===e.indexOf(t.keyring_connection_ID)}):[],s=Object(k.includes)(Object(k.map)(t,"service"),"twitter"),o=s?234:null,i=n.props.post?n.props.post.title:"";if(n.hasConnections())return f.a.createElement(S.a,{message:E.a.publicizeMessage(n.props.post)||"",onChange:n.onMessageChange,requireCount:s,acceptableLength:o,preFilledMessage:i})},n.onMessageChange=function(e){n.props.updatePostMetadata(n.props.siteId,n.props.postId,"_wpas_mess",e)},n.renderAddNewButton=function(){if(n.props.canUserPublishPosts)return f.a.createElement(V.a,{borderless:!0,compact:!0,onClick:n.newConnection},f.a.createElement(O.a,{icon:"add"})," ",n.props.translate("Connect new service"),f.a.createElement("span",{className:"editor-sharing__external-link-indicator"},f.a.createElement(O.a,{icon:"external",size:18})))},n.renderInfoNotice=function(){if(n.hasConnections()||n.props.canUserPublishPosts)return f.a.createElement("p",{className:"editor-drawer__description"},n.props.translate("Connect and select social media services to automatically share this post."))},n}return u()(t,e),r()(t,[{key:"componentWillUnmount",value:function(){this.connectionPopupMonitor&&this.connectionPopupMonitor.off("close",this.onNewConnectionPopupClosed)}},{key:"render",value:function(){if(!this.props.isPublicizeEnabled)return null;var e=_()("editor-sharing__publicize-options",{"has-connections":this.hasConnections(),"has-add-option":this.props.canUserPublishPosts});return f.a.createElement("div",{className:e},this.props.siteId&&f.a.createElement(P.a,{siteId:this.props.siteId}),this.renderInfoNotice(),this.renderServices(),this.renderAddNewButton(),this.renderMessage())}}]),t}(f.a.Component);Y.propTypes={site:b.a.object,post:b.a.object,siteId:b.a.number,isPublicizeEnabled:b.a.bool,connections:b.a.array,requestConnections:b.a.func};var Z=Object(v.b)(function(e){var t=Object(M.e)(e),n=Object(T.g)(e),s=Object(B.f)(e),o=Object($.l)(e,t),i=Object(R.a)(e,t,s),r=Object(R.c)(e,t,s,"type"),a=Object(Q.a)(e,t,"publish_posts");return{siteId:t,postId:s,site:o,post:i,isPublicizeEnabled:Object(X.a)(e,t,r),canUserPublishPosts:a,connections:Object(U.c)(e,t,n)}},{requestConnections:G.f,updatePostMetadata:L.o,recordEditorStat:z.b,recordEditorEvent:z.a})(Object(m.localize)(Y)),ee=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),te=n.n(ee),ne=n("./client/post-editor/editor-fieldset/index.jsx"),se=function(e){function t(){var e,n;o()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=c()(this,(e=p()(t)).call.apply(e,[this].concat(i))),n.onChange=function(e){n.props.editPost(n.props.siteId,n.props.postId,te()({},e.target.name,e.target.checked)),n.recordStats(e)},n}return u()(t,e),r()(t,[{key:"renderSharingButtonField",value:function(){if(this.props.isSharingButtonsEnabled)return f.a.createElement("label",null,f.a.createElement(w.a,{name:"sharing_enabled",checked:this.props.isShowingSharingButtons,onChange:this.onChange}),f.a.createElement("span",null,this.props.translate("Show Sharing Buttons",{context:"Post Editor"})))}},{key:"renderLikesButtonField",value:function(){if(this.props.isLikesEnabled)return f.a.createElement("label",null,f.a.createElement(w.a,{name:"likes_enabled",checked:this.props.isShowingLikeButton,onChange:this.onChange}),f.a.createElement("span",null,this.props.translate("Show Like Button",{context:"Post Editor"})))}},{key:"recordStats",value:function(e){var t=e.target.name,n="sharing_enabled"===e.target.name?"Sharing Buttons":"Like Button";t+=e.target.checked?"_enabled":"_disabled",n+=e.target.checked?" Enabled":" Disabled",this.props.recordEditorStat(t),this.props.recordEditorEvent(n)}},{key:"render",value:function(){return this.props.isSharingButtonsEnabled||this.props.isLikesEnabled?f.a.createElement(ne.a,{className:"editor-sharing__sharing-like-options",legend:this.props.translate("Sharing Buttons & Likes")},this.renderSharingButtonField(),this.renderLikesButtonField()):null}}]),t}(f.a.Component);se.propTypes={siteId:b.a.number,postId:b.a.number,isSharingButtonsEnabled:b.a.bool,isLikesEnabled:b.a.bool,isShowingSharingButtons:b.a.bool,isShowingLikeButton:b.a.bool};var oe=Object(v.b)(function(e){var t=Object(M.e)(e),n=Object($.l)(e,t),s=Object(B.f)(e),o=Object(R.a)(e,t,s),i=Object(B.m)(e);return{siteId:t,postId:s,isSharingButtonsEnabled:!1!==Object($.J)(e,t,"sharedaddy"),isLikesEnabled:!1!==Object($.J)(e,t,"likes"),isShowingSharingButtons:function(e,t,n){return t&&"sharing_enabled"in t?t.sharing_enabled:!e||!n||e.options.default_sharing_status}(n,o,i),isShowingLikeButton:function(e,t,n){return t&&"likes_enabled"in t?t.likes_enabled:!e||!n||e.options.default_likes_enabled}(n,o,i)}},{editPost:L.e,recordEditorStat:z.b,recordEditorEvent:z.a})(Object(m.localize)(se));function ie(){return f.a.createElement("div",{className:"editor-sharing"},f.a.createElement(Z,null),f.a.createElement(oe,null))}var re=n("./client/components/accordion/section.jsx"),ae=n("./client/state/posts/utils.js"),ce=n("./client/lib/viewport/index.js"),le=n("./client/components/data/query-publicize-connections/index.jsx"),pe=n("./client/state/selectors/has-broken-site-user-connection.js"),de=n("./client/state/analytics/actions.js"),ue=function(e){function t(){return o()(this,t),c()(this,p()(t).apply(this,arguments))}return u()(t,e),r()(t,[{key:"getSubtitle",value:function(){var e=this.props,t=e.post,n=e.connections;if(this.props.isPublicizeEnabled&&t&&n){var s=E.a.publicizeSkipped(t);return Object(k.reduce)(n,function(e,t){var n=t.keyring_connection_ID,o=t.label;return Object(k.includes)(s,n)||Object(k.includes)(e,o)||e.push(o),e},[]).join(", ")}}},{key:"renderShortUrl",value:function(){var e=_()("editor-sharing__shortlink",{"is-standalone":this.hideSharing()});return ae.z(this.props.post)?f.a.createElement("div",{className:e},f.a.createElement("label",{className:"editor-sharing__shortlink-label",htmlFor:"shortlink-field"},this.props.translate("Shortlink")),f.a.createElement(y.a,{className:"editor-sharing__shortlink-field",id:"shortlink-field",value:this.props.post.short_URL,size:this.props.post.short_URL&&this.props.post.short_URL.length,readOnly:!0,selectOnFocus:!0})):null}},{key:"hideSharing",value:function(){return!this.props.isSharingActive&&!this.props.isLikesActive&&!this.props.isPublicizeEnabled}},{key:"render",value:function(){var e,t=this.hideSharing(),n=_()("editor-sharing__accordion",this.props.className,{"is-loading":!this.props.post||!this.props.connections});return t&&!ae.z(this.props.post)?null:(this.props.hasBrokenConnection&&(e={type:"warning",text:this.props.translate("A broken connection requires repair",{comment:"Publicize connection deauthorized, needs user action to fix"}),url:"/sharing/"+this.props.siteSlug,position:Object(ce.c)()?"top left":"top",onClick:this.props.onStatusClick}),f.a.createElement(C.a,{title:this.props.translate("Sharing"),subtitle:this.getSubtitle(),status:e,className:n,e2eTitle:"sharing"},this.props.siteId&&f.a.createElement(le.a,{siteId:this.props.siteId}),f.a.createElement(re.a,null,!t&&f.a.createElement(ie,null),this.renderShortUrl())))}}]),t}(f.a.Component);ue.propTypes={siteId:b.a.number,siteSlug:b.a.string,post:b.a.object,connections:b.a.array,hasBrokenConnection:b.a.bool,isPublicizeEnabled:b.a.bool,isSharingActive:b.a.bool,isLikesActive:b.a.bool};t.default=Object(v.b)(function(e){var t=Object(M.e)(e),n=Object(T.g)(e),s=Object(B.f)(e),o=Object(R.a)(e,t,s),i=Object(R.c)(e,t,s,"type"),r=!1!==Object($.J)(e,t,"sharedaddy"),a=!1!==Object($.J)(e,t,"likes");return{siteId:t,siteSlug:Object($.w)(e,t),post:o,connections:Object(U.c)(e,t,n),hasBrokenConnection:Object(pe.a)(e,t,n),isSharingActive:r,isLikesActive:a,isPublicizeEnabled:Object(X.a)(e,t,i)}},{onStatusClick:function(){return Object(de.g)("Editor","Clicked Accordion Broken Status")}})(Object(m.localize)(ue))},"./client/post-editor/editor-sharing/publicize-message.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),a=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=n.n(a),l=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(l),d=n("./node_modules/@babel/runtime/helpers/inherits.js"),u=n.n(d),h=n("./node_modules/react/index.js"),b=n.n(h),m=n("./node_modules/react-redux/es/index.js"),g=n("./node_modules/i18n-calypso/index.js"),f=n("./node_modules/prop-types/index.js"),j=n.n(f),_=n("./node_modules/lodash/lodash.js"),v=n("./client/components/forms/counted-textarea/index.jsx"),k=n("./client/post-editor/editor-drawer/label.jsx"),C=n("./client/components/forms/form-textarea/index.jsx"),y=n("./client/components/info-popover/index.jsx"),E=n("./client/components/track-input-changes/index.jsx"),x=n("./client/state/posts/stats.js"),O=function(e){function t(){var e,n;o()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=c()(this,(e=p()(t)).call.apply(e,[this].concat(i))),n.userHasEditedMessage=!1,n.onChange=function(e){n.userHasEditedMessage=!0,n.props.onChange(e.target.value)},n.recordStats=function(){n.props.recordEditorStat("sharing_message_changed"),n.props.recordEditorEvent("Publicize Sharing Message Changed")},n}return u()(t,e),r()(t,[{key:"shouldPreFillMessage",value:function(){return!this.userHasEditedMessage&&""===this.props.message}},{key:"getMessage",value:function(){return this.shouldPreFillMessage()?this.props.preFilledMessage:this.props.message}},{key:"renderInfoPopover",value:function(){return b.a.createElement(y.a,{className:"editor-sharing__publicize-message-counter-info",position:"bottom left",gaEventCategory:"Editor",popoverName:"SharingMessage"},this.props.translate("The length includes space for the link to your post and an attached image.",{context:"Post editor sharing message counter explanation"}))}},{key:"renderTextarea",value:function(){var e=this.props.preview||this.props.translate("Write a message for your audience here.");return this.props.requireCount?b.a.createElement(v.a,{disabled:this.props.disabled,placeholder:e,countPlaceholderLength:!0,value:this.getMessage(),onChange:this.onChange,showRemainingCharacters:!0,acceptableLength:this.props.acceptableLength,className:"editor-sharing__message-input"},this.renderInfoPopover()):b.a.createElement(C.a,{disabled:this.props.disabled,value:this.getMessage(),placeholder:e,onChange:this.onChange,className:"editor-sharing__message-input"})}},{key:"render",value:function(){var e=this.props,t=e.displayMessageHeading,n=e.translate;return b.a.createElement("div",{className:"editor-sharing__publicize-message"},t&&b.a.createElement(k.a,{helpText:n("The following text will be shared along with a link to your post."),labelText:n("Customize the message",{context:"Post editor sharing message heading"})},b.a.createElement(E.a,{onNewValue:this.recordStats},this.renderTextarea())),!t&&b.a.createElement(E.a,{onNewValue:this.recordStats},this.renderTextarea()))}}]),t}(h.Component);O.propTypes={disabled:j.a.bool,message:j.a.string,preview:j.a.string,acceptableLength:j.a.number,requireCount:j.a.bool,displayMessageHeading:j.a.bool,onChange:j.a.func,preFilledMessage:j.a.string},O.defaultProps={disabled:!1,message:"",acceptableLength:280,requireCount:!1,displayMessageHeading:!0,onChange:_.noop,preFilledMessage:""},t.a=Object(m.b)(null,{recordEditorStat:x.b,recordEditorEvent:x.a})(Object(g.localize)(O))},"./client/state/selectors/is-publicize-enabled.js":function(e,t,n){"use strict";n.d(t,"a",function(){return i});var s=n("./client/state/sites/selectors.js"),o=n("./client/state/post-types/selectors.js");function i(e,t,n){return!0!==Object(s.s)(e,t,"publicize_permanently_disabled")&&!1!==Object(s.J)(e,t,"publicize")&&Object(o.d)(e,t,n,"publicize")}}}]);