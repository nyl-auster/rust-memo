(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"./client/blocks/plan-storage/bar.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/prop-types/index.js"),h=n.n(m),b=n("./node_modules/react/index.js"),f=n.n(b),g=n("./node_modules/i18n-calypso/index.js"),v=n("./node_modules/classnames/index.js"),y=n.n(v),j=n("./node_modules/filesize/lib/filesize.js"),_=n.n(j),x=n("./client/components/progress-bar/index.jsx"),E=n("./client/lib/plans/index.js"),k=n("./client/lib/plans/constants.js"),I=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.mediaStorage,s=e.sitePlanSlug,a=e.siteSlug,i=e.translate;if(Object(E.v)(s,k.v))return null;if(!n||-1===n.max_storage_bytes)return null;var r=Math.min(Math.round(n.storage_used_bytes/n.max_storage_bytes*1e3)/10,100),o=y()(t,"plan-storage__bar",{"is-alert":r>80,"is-warn":r>60&&r<=80}),l=_()(n.max_storage_bytes);return f.a.createElement("div",{className:o},f.a.createElement(x.a,{value:r,total:100,compact:!0}),f.a.createElement("span",{className:"plan-storage__storage-label"},i("%(percent)f%% of %(max)s used",{args:{percent:r,max:l}})),f.a.createElement("a",{className:"plan-storage__storage-link",href:"/plans/"+a},i("Upgrade")),this.props.children)}}]),t}(b.Component);I.propTypes={className:h.a.string,mediaStorage:h.a.object,siteSlug:h.a.string.isRequired,sitePlanSlug:h.a.string.isRequired},I.defaultProps={siteSlug:""},t.a=Object(g.localize)(I)},"./client/blocks/plan-storage/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/classnames/index.js"),h=n.n(m),b=n("./node_modules/prop-types/index.js"),f=n.n(b),g=n("./node_modules/react/index.js"),v=n.n(g),y=n("./node_modules/react-redux/es/index.js"),j=n("./client/components/data/query-media-storage/index.jsx"),_=n("./client/state/sites/media-storage/selectors.js"),x=n("./client/state/sites/selectors.js"),E=n("./client/lib/plans/index.js"),k=n("./client/lib/plans/constants.js"),I=n("./client/blocks/plan-storage/bar.jsx"),C=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=e.jetpackSite,s=e.siteId,a=e.sitePlanSlug,i=e.siteSlug;return n||!a?null:Object(E.v)(a,k.v)?null:v.a.createElement("div",{className:h()(t,"plan-storage")},v.a.createElement(j.a,{siteId:s}),v.a.createElement(I.a,{siteSlug:i,sitePlanSlug:a,mediaStorage:this.props.mediaStorage},this.props.children))}}]),t}(g.Component);C.propTypes={className:f.a.string,mediaStorage:f.a.object,siteId:f.a.number,sitePlanSlug:f.a.string,siteSlug:f.a.string},t.a=Object(y.b)(function(e,t){var n=t.siteId;return{mediaStorage:Object(_.a)(e,n),jetpackSite:Object(x.K)(e,n),sitePlanSlug:Object(x.u)(e,n),siteSlug:Object(x.w)(e,n)}})(C)},"./client/blocks/video-editor/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/prop-types/index.js"),h=n.n(m),b=n("./node_modules/react/index.js"),f=n.n(b),g=n("./node_modules/react-redux/es/index.js"),v=n("./node_modules/lodash/lodash.js"),y=n("./node_modules/i18n-calypso/index.js"),j=n("./node_modules/classnames/index.js"),_=n.n(j),x=n("./client/components/progress-bar/index.jsx"),E=n("./client/components/notice/index.jsx"),k=n("./client/post-editor/media-modal/detail/detail-preview-video.jsx"),I=n("./client/components/button/index.jsx"),C=n("./client/components/file-picker/index.jsx"),S=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.uploadImage=function(e){var t=e[0];t&&n.props.onUploadImage(t)},n}return p()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.isPosterUpdating,s=e.onClick;return f.a.createElement("form",{className:"video-editor__upload-form"},f.a.createElement(C.a,{accept:"image/*",onPick:this.uploadImage},f.a.createElement(I.a,{className:"video-editor__controls-button",disabled:n,onClick:s},t)))}}]),t}(b.Component);S.propTypes={isPosterUpdating:h.a.bool,onClick:h.a.func,onUploadImage:h.a.func},S.defaultProps={isPosterUpdating:!1,onClick:v.noop,onUploadImage:v.noop};var O=S,N=function(e){var t=e.isPosterUpdating,n=e.isVideoLoading,s=e.onCancel,a=e.onSelectFrame,i=e.onUploadImage,r=e.onUploadImageClick,o=e.translate;return f.a.createElement("div",{className:"video-editor__controls"},s&&f.a.createElement(I.a,{className:"video-editor__controls-button",disabled:t,onClick:s},o("Cancel")),f.a.createElement(O,{isPosterUpdating:t,onClick:r,onUploadImage:i},o("Upload Image")),f.a.createElement(I.a,{className:"video-editor__controls-button",disabled:n||t,onClick:a,primary:!0},o("Select Frame")))};N.propTypes={isPosterUpdating:h.a.bool,isVideoLoading:h.a.bool,onCancel:h.a.func,onSelectFrame:h.a.func,onUploadImage:h.a.func,onUploadImageClick:h.a.func},N.defaultProps={isPosterUpdating:!1,isVideoLoading:!0,onSelectFrame:v.noop,onUploadImage:v.noop,onUploadImageClick:v.noop};var P=Object(y.localize)(N),w=n("./client/state/ui/editor/video-editor/actions.js");var M=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.state={error:!1,isLoading:!0,isSelectingFrame:!1,pauseVideo:!1},n.selectFrame=function(){var e=n.state.isLoading;e?n.setState({error:!0}):n.setState({error:!1,isSelectingFrame:!0,pauseVideo:!0})},n.updatePoster=function(e){if(n.state.isSelectingFrame){var t=n.props.media,s=Object(v.get)(t,"videopress_guid",null);s&&n.props.updatePoster(s,{atTime:e})}},n.setError=function(){n.setState({error:!0})},n.setIsLoading=function(){n.setState({isLoading:!1})},n.pauseVideo=function(){n.setState({error:!1,isSelectingFrame:!1,pauseVideo:!0})},n.uploadImage=function(e){if(e){var t=n.props.media,s=Object(v.get)(t,"videopress_guid",null);s&&n.props.updatePoster(s,{file:e})}},n}return p()(t,e),r()(t,[{key:"componentWillReceiveProps",value:function(e){!e.shouldShowError||this.props.shouldShowError?this.props.posterUrl!==e.posterUrl&&this.props.onUpdatePoster(this.getVideoEditorProps(e.posterUrl)):this.setState({error:!0,pauseVideo:!1})}},{key:"getVideoEditorProps",value:function(e){var t=this.props.media,n={posterUrl:e};return t&&t.ID&&(n.ID=t.ID),n}},{key:"renderError",value:function(){var e=this.props,t=e.onCancel,n=e.translate;return f.a.createElement(E.b,{status:"is-error",showDismiss:!0,text:n("We are unable to edit this video."),isCompact:!1,onDismissClick:t})}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.media,s=e.onCancel,a=e.uploadProgress,i=e.translate,r=this.state,o=r.error,l=r.isLoading,c=r.isSelectingFrame,d=r.pauseVideo,u=_()("video-editor",t);return f.a.createElement("div",{className:u},o&&this.renderError(),f.a.createElement("figure",null,f.a.createElement("div",{className:"video-editor__content"},f.a.createElement("div",{className:"video-editor__preview-wrapper"},f.a.createElement(k.a,{className:"video-editor__preview",isPlaying:!d,item:n,onPause:this.updatePoster,onScriptLoadError:this.setError,onVideoLoaded:this.setIsLoading})),a&&!o&&!c&&f.a.createElement(x.a,{className:"video-editor__progress-bar",isPulsing:!0,total:100,value:a}),f.a.createElement("span",{className:"video-editor__text"},i("Select a frame to use as the thumbnail image or upload your own.")),f.a.createElement(P,{isPosterUpdating:a&&!o,isVideoLoading:l,onCancel:s,onSelectFrame:this.selectFrame,onUploadImage:this.uploadImage,onUploadImageClick:this.pauseVideo}))))}}]),t}(b.Component);M.propTypes={className:h.a.string,media:h.a.object.isRequired,onCancel:h.a.func,onUpdatePoster:h.a.func,posterUrl:h.a.string,shouldShowError:h.a.bool,uploadProgress:h.a.number},M.defaultProps={onCancel:v.noop,onUpdatePoster:v.noop};t.a=Object(g.b)(function(e){return{posterUrl:function(e){return e.ui.editor.videoEditor.url}(e),shouldShowError:function(e){return e.ui.editor.videoEditor.showError}(e),uploadProgress:function(e){return e.ui.editor.videoEditor.uploadProgress}(e)}},{updatePoster:w.d})(Object(y.localize)(M))},"./client/components/button-group/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/react/index.js"),h=n.n(m),b=n("./node_modules/classnames/index.js"),f=n.n(b),g=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){var e=f()("button-group",this.props.className,{"is-busy":this.props.busy,"is-primary":this.props.primary});return h.a.createElement("span",{className:e},this.props.children)}}]),t}(m.PureComponent);g.propTypes={children:function(e){var t=null;return h.a.Children.forEach(e.children,function(e){!e||e.props&&"button"===e.props.type||(t=new Error("All children elements should be a Button."))}),t}},t.a=g},"./client/components/clipboard-button-input/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/extends.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/inherits.js"),h=n.n(m),b=n("./node_modules/react/index.js"),f=n.n(b),g=n("./node_modules/prop-types/index.js"),v=n.n(g),y=n("./node_modules/classnames/index.js"),j=n.n(y),_=n("./node_modules/lodash/lodash.js"),x=n("./node_modules/i18n-calypso/index.js"),E=n("./node_modules/react-redux/es/index.js"),k=n("./client/lib/url/index.js"),I=n("./client/components/forms/clipboard-button/index.jsx"),C=n("./client/components/forms/form-text-input/index.jsx"),S=n("./client/state/analytics/actions.js"),O=function(e){function t(e){var n;return r()(this,t),n=d()(this,p()(t).call(this,e)),n.showConfirmation=function(){n.setState({isCopied:!0}),n.confirmationTimeout=setTimeout(function(){n.setState({isCopied:!1})},4e3),n.props.recordTracksEvent("calypso_editor_clipboard_url_button_click")},n.state={isCopied:!1,disabled:!1},n}return h()(t,e),l()(t,[{key:"componentWillUnmount",value:function(){clearTimeout(this.confirmationTimeout),delete this.confirmationTimeout}},{key:"render",value:function(){var e=this.props,t=e.value,n=e.className,s=e.disabled,i=e.hideHttp,r=e.translate,o=j()("clipboard-button-input",n);return f.a.createElement("span",{className:o},f.a.createElement(C.a,a()({},Object(_.omit)(this.props,"className","hideHttp","moment","numberFormat","translate","recordTracksEvent"),{value:i?Object(k.m)(t):t,type:"text",selectOnFocus:!0,readOnly:!0})),f.a.createElement(I.a,{text:t,onCopy:this.showConfirmation,disabled:s,compact:!0},this.state.isCopied?r("Copied!"):r("Copy",{context:"verb"})))}}]),t}(f.a.Component);O.propTypes={value:v.a.string,disabled:v.a.bool,className:v.a.string,hideHttp:v.a.bool,moment:v.a.func,numberFormat:v.a.func,translate:v.a.func},O.defaultProps={value:""},t.a=Object(E.b)(null,{recordTracksEvent:S.i})(Object(x.localize)(O))},"./client/components/data/query-media-storage/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=n.n(m),b=n("./node_modules/prop-types/index.js"),f=n.n(b),g=n("./node_modules/react/index.js"),v=n("./node_modules/react-redux/es/index.js"),y=n("./node_modules/redux/es/redux.js"),j=n("./client/state/sites/media-storage/selectors.js"),_=n("./client/lib/wp/browser.js");function x(e){return function(t){return t({type:"SITE_MEDIA_STORAGE_REQUEST",siteId:e}),_.a.undocumented().site(e).mediaStorage().then(function(n){t(function(e,t){return{type:"SITE_MEDIA_STORAGE_RECEIVE",mediaStorage:e,siteId:t}}(n,e)),t({type:"SITE_MEDIA_STORAGE_REQUEST_SUCCESS",siteId:e})}).catch(function(n){t({type:"SITE_MEDIA_STORAGE_REQUEST_FAILURE",siteId:e,error:n})})}}var E=n("./client/lib/media/store.js"),k=function(e){function t(e){var n;return a()(this,t),n=l()(this,d()(t).call(this,e)),n.requestStorage=n.requestStorage.bind(h()(h()(n))),n}return p()(t,e),r()(t,[{key:"requestStorage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props;!e.requestingMediaStorage&&e.siteId&&e.requestMediaStorage(e.siteId)}},{key:"componentWillMount",value:function(){this.requestStorage(),E.a.on("fetch-media-limits",this.requestStorage)}},{key:"componentWillUnmount",value:function(){E.a.off("fetch-media-limits",this.requestStorage)}},{key:"componentWillReceiveProps",value:function(e){!e.requestingMediaStorage&&e.siteId&&this.props.siteId!==e.siteId&&this.requestStorage(e)}},{key:"render",value:function(){return null}}]),t}(g.Component);k.propTypes={siteId:f.a.number,requestingMediaStorage:f.a.bool,requestMediaStorage:f.a.func},k.defaultProps={requestMediaStorage:function(){}};t.a=Object(v.b)(function(e,t){return{requestingMediaStorage:Object(j.b)(e,t.siteId)}},function(e){return Object(y.b)({requestMediaStorage:x},e)})(k)},"./client/components/forms/clipboard-button/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/extends.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/inherits.js"),h=n.n(m),b=n("./node_modules/react/index.js"),f=n.n(b),g=n("./node_modules/prop-types/index.js"),v=n.n(g),y=n("./node_modules/i18n-calypso/index.js"),j=n("./node_modules/react-dom/index.js"),_=n.n(j),x=n("./node_modules/clipboard/dist/clipboard.js"),E=n.n(x),k=n("./node_modules/lodash/lodash.js"),I=n("./node_modules/classnames/index.js"),C=n.n(I),S=n("./client/components/button/index.jsx"),O=function(e){function t(){var e,n;r()(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return n=d()(this,(e=p()(t)).call.apply(e,[this].concat(a))),n.buttonReference=f.a.createRef(),n.displayPrompt=function(){window.prompt(n.props.translate("Highlight and copy the following text to your clipboard:"),n.props.text)},n}return h()(t,e),l()(t,[{key:"componentDidMount",value:function(){var e=this,t=_.a.findDOMNode(this.buttonReference.current);this.clipboard=new E.a(t,{text:function(){return e.props.text}}),this.clipboard.on("success",this.props.onCopy),this.clipboard.on("error",this.displayPrompt)}},{key:"componentWillUnmount",value:function(){this.clipboard.destroy(),delete this.clipboard}},{key:"render",value:function(){var e=C()("clipboard-button",this.props.className);return f.a.createElement(S.a,a()({ref:this.buttonReference},Object(k.omit)(this.props,Object.keys(this.constructor.propTypes)),{className:e}))}}]),t}(f.a.Component);O.propTypes={className:v.a.string,text:v.a.string,onCopy:v.a.func,moment:v.a.func,numberFormat:v.a.func,translate:v.a.func},O.defaultProps={onCopy:k.noop},t.a=Object(y.localize)(O)},"./client/components/segmented-control/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=n.n(m),b=n("./node_modules/lodash/lodash.js"),f=n("./node_modules/prop-types/index.js"),g=n.n(f),v=n("./node_modules/react-dom/index.js"),y=n.n(v),j=n("./node_modules/react/index.js"),_=n.n(j),x=n("./node_modules/classnames/index.js"),E=n.n(x),k=n("./client/components/segmented-control/item.jsx"),I=1,C=function(e){function t(e){var n,s;return a()(this,t),n=l()(this,d()(t).call(this,e)),n.getSegmentedItems=function(){var e=0;return n.props.children?_.a.Children.map(n.props.children,function(t,n){var s=_.a.cloneElement(t,{ref:t.type===k.a?"item-"+e:null,key:"item-"+n,onClick:function(e){this.setKeyboardNavigation(!1),"function"==typeof t.props.onClick&&t.props.onClick(e)}.bind(this)});return t.type===k.a&&e++,s},h()(h()(n))):n.props.options.map(function(e,t){return _.a.createElement(k.a,{key:"segmented-control-"+this.id+"-"+e.value,ref:"item-"+t,selected:this.state.selected===e.value,onClick:this.selectItem.bind(this,e),path:e.path,index:t,value:e.value},e.label)},h()(h()(n)))},n.selectItem=function(e){e&&(n.props.onSelect&&n.props.onSelect(e),n.setState({selected:e.value,keyboardNavigation:!1}))},n.setKeyboardNavigation=function(e){n.setState({keyboardNavigation:e})},n.navigateItem=function(e){switch(e.keyCode){case 9:n.navigateItemByTabKey(e);break;case 32:case 13:e.preventDefault(),document.activeElement.click();break;case 37:e.preventDefault(),n.focusSibling("previous");break;case 39:e.preventDefault(),n.focusSibling("next")}},n.navigateItemByTabKey=function(e){var t=e.shiftKey?"previous":"next",s=n.focusSibling(t);!1!==s&&e.preventDefault()},n.focusSibling=function(e){var t,s,a;return s=n.props.options?Object(b.filter)(Object(b.map)(n.props.options,"value"),Boolean):Object(b.filter)(n.props.children,function(e){return e.type===k.a}),"number"!=typeof n.focused&&(n.focused=n.getCurrentFocusedIndex()),t="previous"===e?-1:1,a=n.focused+t,!(a>=s.length||a<0)&&(y.a.findDOMNode(n.refs["item-"+a].refs.itemLink).focus(),n.focused=a,a)},n.getCurrentFocusedIndex=function(){var e=document.activeElement.parentNode,t=Array.prototype.slice(e.parentNode.children),n=t.indexOf(e);return n>-1?n:0},e.options&&(s=e.initialSelected||e.options[0].value),n.state={selected:s,keyboardNavigation:!1},n}return p()(t,e),r()(t,[{key:"componentWillMount",value:function(){this.id=I,I++}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keydown",this.navigateItem)}},{key:"render",value:function(){var e={"segmented-control":!0,"keyboard-navigation":this.state.keyboardNavigation,"is-compact":this.props.compact,"is-primary":this.props.primary};return this.props.className&&this.props.className.split(" ").forEach(function(t){e[t]=!0}),_.a.createElement("ul",{className:E()(e),style:this.props.style,role:"radiogroup",onKeyDown:this.navigateItem,onKeyUp:this.setKeyboardNavigation.bind(this,!0)},this.getSegmentedItems())}}]),t}(_.a.Component);C.propTypes={initialSelected:g.a.string,compact:g.a.bool,className:g.a.string,style:g.a.object,onSelect:g.a.func,options:g.a.arrayOf(g.a.shape({value:g.a.string.isRequired,label:g.a.string.isRequired,path:g.a.string}))},C.defaultProps={compact:!1},t.a=C},"./client/components/segmented-control/item.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/inherits.js"),h=n.n(m),b=n("./node_modules/prop-types/index.js"),f=n.n(b),g=n("./node_modules/react/index.js"),v=n.n(g),y=n("./node_modules/classnames/index.js"),j=n.n(y),_=function(e){function t(){return r()(this,t),d()(this,p()(t).apply(this,arguments))}return h()(t,e),l()(t,[{key:"render",value:function(){var e=j()({"segmented-control__item":!0,"is-selected":this.props.selected}),t=j()("segmented-control__link",a()({},"item-index-"+this.props.index,null!=this.props.index));return v.a.createElement("li",{className:e},v.a.createElement("a",{href:this.props.path,className:t,ref:"itemLink",onClick:this.props.onClick,title:this.props.title,"data-e2e-value":this.props.value,role:"radio",tabIndex:0,"aria-selected":this.props.selected},v.a.createElement("span",{className:"segmented-control__text"},this.props.children)))}}]),t}(v.a.Component);_.propTypes={children:f.a.node.isRequired,path:f.a.string,selected:f.a.bool,title:f.a.string,value:f.a.string,onClick:f.a.func},_.defaultProps={selected:!1},t.a=_},"./client/components/sticky-panel/index.jsx":function(e,t,n){"use strict";n.d(t,"a",function(){return I});var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=n.n(m),b=n("./node_modules/lodash/lodash.js"),f=n("./node_modules/prop-types/index.js"),g=n.n(f),v=n("./node_modules/react-dom/index.js"),y=n.n(v),j=n("./node_modules/react/index.js"),_=n.n(j),x=n("./node_modules/classnames/index.js"),E=n.n(x),k=n("./client/lib/viewport/index.js"),I=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.state={isSticky:!1,spacerHeight:0,blockWidth:0},n.onWindowScroll=function(){n.rafHandle=window.requestAnimationFrame(n.updateIsSticky)},n.onWindowResize=function(){n.setState({spacerHeight:n.state.isSticky?y.a.findDOMNode(h()(h()(n))).clientHeight:0,blockWidth:n.state.isSticky?y.a.findDOMNode(h()(h()(n))).clientWidth:0})},n.updateIsSticky=function(){var e=window.pageYOffset>n.threshold;if(!1!==n.props.minLimit&&n.props.minLimit>=window.innerWidth||Object(k.c)())return n.setState({isSticky:!1});e!==n.state.isSticky&&n.setState({isSticky:e,spacerHeight:e?y.a.findDOMNode(h()(h()(n))).clientHeight:0,blockWidth:e?y.a.findDOMNode(h()(h()(n))).clientWidth:0})},n.getBlockStyle=function(){var e;if(n.state.isSticky)return e=document.getElementById("header").getBoundingClientRect().height,{top:e,width:n.state.blockWidth}},n}return p()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.threshold=y.a.findDOMNode(this).offsetTop,this.throttleOnResize=Object(b.throttle)(this.onWindowResize,200),window.addEventListener("scroll",this.onWindowScroll),window.addEventListener("resize",this.throttleOnResize),this.updateIsSticky()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("scroll",this.onWindowScroll),window.removeEventListener("resize",this.throttleOnResize),window.cancelAnimationFrame(this.rafHandle)}},{key:"render",value:function(){var e=E()("sticky-panel",this.props.className,{"is-sticky":this.state.isSticky});return _.a.createElement("div",{className:e},_.a.createElement("div",{className:"sticky-panel__content",style:this.getBlockStyle()},this.props.children),_.a.createElement("div",{className:"sticky-panel__spacer",style:{height:this.state.spacerHeight}}))}}]),t}(_.a.Component);I.displayName="StickyPanel",I.propTypes={minLimit:g.a.oneOfType([g.a.bool,g.a.number])},I.defaultProps={minLimit:!1}},"./client/components/track-input-changes/index.jsx":function(e,t,n){"use strict";n.d(t,"a",function(){return v});var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/react/index.js"),h=n.n(m),b=n("./node_modules/prop-types/index.js"),f=n.n(b),g=n("./node_modules/lodash/lodash.js"),v=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.onInputChange=function(){n.inputEdited=!0},n.onInputBlur=function(e){n.inputEdited&&(n.props.onNewValue(e),n.inputEdited=!1)},n}return p()(t,e),r()(t,[{key:"componentWillMount",value:function(){this.inputEdited=!1}},{key:"render",value:function(){var e=this,t=h.a.Children.only(this.props.children),n=Object(g.assign)({},t.props,{onChange:function(n){"function"==typeof t.props.onChange&&t.props.onChange.call(t,n),e.onInputChange(n)},onBlur:function(n){"function"==typeof t.props.onBlur&&t.props.onBlur.call(t,n),e.onInputBlur(n)}});return h.a.cloneElement(t,n)}}]),t}(m.Component);v.displayName="TrackInputChanges",v.propTypes={onNewValue:f.a.func},v.defaultProps={onNewValue:g.noop}},"./client/lib/accept/index.js":function(e,t,n){"use strict";var s=n("./node_modules/react-dom/index.js"),a=n.n(s),i=n("./node_modules/react/index.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/createClass.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=n.n(m),b=n("./node_modules/@babel/runtime/helpers/inherits.js"),f=n.n(b),g=n("./node_modules/prop-types/index.js"),v=n.n(g),y=n("./node_modules/i18n-calypso/index.js"),j=n("./node_modules/classnames/index.js"),_=n.n(j),x=n("./client/components/dialog/index.jsx"),E=function(e){function t(){var e,n;l()(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return n=p()(this,(e=h()(t)).call.apply(e,[this].concat(a))),n.state={isVisible:!0},n.onClose=function(e){n.setState({isVisible:!1}),n.props.onClose("accept"===e)},n.getActionButtons=function(){var e=n.props.options,t=e&&e.isScary,s=_()({"is-scary":t});return[{action:"cancel",label:n.props.cancelButtonText?n.props.cancelButtonText:n.props.translate("Cancel"),additionalClassNames:"is-cancel"},{action:"accept",label:n.props.confirmButtonText?n.props.confirmButtonText:n.props.translate("OK"),isPrimary:!0,additionalClassNames:s}]},n}return f()(t,e),d()(t,[{key:"render",value:function(){return this.state.isVisible?r.a.createElement(x.a,{buttons:this.getActionButtons(),onClose:this.onClose,className:"accept-dialog",isVisible:!0},this.props.message):null}}]),t}(i.Component);E.displayName="AcceptDialog",E.propTypes={translate:v.a.func,message:v.a.node,onClose:v.a.func.isRequired,confirmButtonText:v.a.node,cancelButtonText:v.a.node,options:v.a.object};var k=Object(y.localize)(E);t.a=function(e,t,n,s,i){var o=document.createElement("div");document.body.appendChild(o),a.a.render(r.a.createElement(k,{message:e,onClose:function(e){o&&(a.a.unmountComponentAtNode(o),document.body.removeChild(o),o=null),t&&t(e)},confirmButtonText:n,cancelButtonText:s,options:i}),o)}},"./client/lib/build-url/index.js":function(e,t,n){"use strict";var s=n("./node_modules/lodash/lodash.js"),a=n("./node_modules/url/url.js"),i=n.n(a);t.a=function(e,t){var n=i.a.parse(e,!0);return t?n.query.s=t:delete n.query.s,n=Object(s.pick)(n,"pathname","hash","query"),i.a.format(n).replace(/\%20/g,"+")}},"./client/lib/search-url/index.js":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var s=n("./node_modules/page/page.js"),a=n.n(s),i=n("./client/lib/build-url/index.js"),r=n("./node_modules/debug/src/browser.js"),o=n.n(r),l=o()("calypso:search-url");function c(e,t,n){if(n)n(e);else{var s=Object(i.a)(window.location.href,e);l("search posts for:",e),t&&e?(l("replacing URL: "+s),a.a.replace(s)):(l("setting URL: "+s),a.a.show(s))}}},"./client/my-sites/media-library/drop-zone.jsx":function(e,t,n){"use strict";n.d(t,"a",function(){return x});var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/prop-types/index.js"),h=n.n(m),b=n("./node_modules/react/index.js"),f=n.n(b),g=n("./node_modules/lodash/lodash.js"),v=n("./client/lib/analytics/index.js"),y=n("./client/components/drop-zone/index.jsx"),j=n("./client/lib/media/actions.js"),_=n("./client/lib/site/utils.js"),x=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.uploadFiles=function(e){n.props.site&&(j.a.clearValidationErrors(n.props.site.ID),j.a.add(n.props.site,e),n.props.onAddMedia(),n.props.trackStats&&v.default.mc.bumpStat("editor_upload_via","drop"))},n.isValidTransfer=function(e){return!!e&&(!e.mozSourceNode&&(!e.types||-1!==Array.prototype.indexOf.call(e.types,"Files")))},n}return p()(t,e),r()(t,[{key:"render",value:function(){return Object(_.g)("upload_files",this.props.site)?f.a.createElement(y.a,{fullScreen:this.props.fullScreen,onVerifyValidTransfer:this.isValidTransfer,onFilesDrop:this.uploadFiles}):null}}]),t}(f.a.Component);x.displayName="MediaLibraryDropZone",x.propTypes={site:h.a.object,fullScreen:h.a.bool,onAddMedia:h.a.func,trackStats:h.a.bool},x.defaultProps={fullScreen:!0,onAddMedia:g.noop,trackStats:!0}},"./client/my-sites/media-library/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/react/index.js"),h=n.n(m),b=n("./node_modules/classnames/index.js"),f=n.n(b),g=n("./node_modules/lodash/lodash.js"),v=n("./node_modules/prop-types/index.js"),y=n.n(v),j=n("./node_modules/react-redux/es/index.js"),_=n("./node_modules/page/page.js"),x=n.n(_),E=n("./node_modules/i18n-calypso/index.js"),k=n("./node_modules/gridicons/dist/index.js"),I=n.n(k),C=n("./client/lib/analytics/index.js"),S=n("./client/lib/analytics/track-component-view/index.jsx"),O=n("./client/components/notice/index.jsx"),N=n("./client/components/notice/notice-action.jsx"),P=n("./client/lib/media/actions.js"),w=n("./client/lib/media/list-store.js"),M=n("./client/lib/react-pass-to-children/index.js"),D={getMimeBaseTypeFromFilter:function(e){var t;switch(e){case"images":t="image/";break;case"audio":t="audio/";break;case"videos":t="video/";break;case"documents":t="application/";break;default:t=""}return t}};function T(e){return{media:w.a.getAll(e),mediaHasNextPage:w.a.hasNextPage(e),mediaFetchingNextPage:w.a.isFetchingNextPage(e)}}var R=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.state=T(n.props.siteId),n.getQuery=function(e){var t={};return e=e||n.props,e.search&&(t.search=e.search),e.filter&&!e.source&&("this-post"===e.filter?e.postId&&(t.post_ID=e.postId):t.mime_type=D.getMimeBaseTypeFromFilter(e.filter)),e.source&&(t.source=e.source,t.path="recent"),t},n.fetchData=function(){P.a.fetchNextPage(n.props.siteId)},n.updateStateData=function(){n.setState(T(n.props.siteId))},n}return p()(t,e),r()(t,[{key:"componentWillMount",value:function(){P.a.setQuery(this.props.siteId,this.getQuery()),w.a.on("change",this.updateStateData),this.updateStateData()}},{key:"componentWillUnmount",value:function(){w.a.off("change",this.updateStateData)}},{key:"componentWillReceiveProps",value:function(e){var t=this.getQuery(e);this.props.siteId===e.siteId&&Object(g.isEqual)(t,this.getQuery())||(P.a.setQuery(e.siteId,t),this.setState(T(e.siteId)))}},{key:"render",value:function(){return Object(M.a)(this,Object(g.assign)({},this.state,{mediaOnFetchNextPage:this.fetchData}))}}]),t}(h.a.Component);R.displayName="MediaListData",R.propTypes={siteId:y.a.number.isRequired,source:y.a.string,postId:y.a.number,filter:y.a.string,search:y.a.string};var L=n("./client/components/data/media-library-selected-data/index.jsx"),A=n("./client/lib/media/constants.js"),U=n("./client/state/sites/selectors.js"),V=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),F=n.n(V),q=n("./client/components/popover/menu.jsx"),z=n("./client/components/popover/menu-item.jsx"),B=n("./client/components/forms/range/index.jsx"),W=n("./client/components/segmented-control/index.jsx"),G=n("./client/components/segmented-control/item.jsx"),H=n("./client/state/preferences/actions.js"),Y=n("./client/state/preferences/selectors.js"),K=[.077,.115,.157,.24,.323],Q=.32,Z=function(e){function t(){var e;return a()(this,t),e=l()(this,d()(t).apply(this,arguments)),e.onScaleChange=e.onScaleChange.bind(F()(F()(e))),e.savePreference=e.savePreference.bind(F()(F()(e))),e.debouncedSavePreference=Object(g.debounce)(e.savePreference,1e3),e.setScaleToMobileGrid=e.setScale.bind(F()(F()(e)),Q),e.setScaleToMobileFull=e.setScale.bind(F()(F()(e)),1),e.state={},e}return p()(t,e),r()(t,[{key:"componentWillUnmount",value:function(){this.debouncedSavePreference.cancel()}},{key:"savePreference",value:function(e){this.props.saveMediaScalePreference(e)}},{key:"setScale",value:function(e){e!==this.props.scale&&(this.props.onChange(e),this.props.setMediaScalePreference(e),this.debouncedSavePreference(e))}},{key:"onScaleChange",value:function(e){var t=parseInt(e.target.value,10),n=t*K.length/100,s=K[Math.floor(n)];this.setState({sliderPosition:t}),this.setScale(s)}},{key:"getSliderPosition",value:function(){if(this.state.hasOwnProperty("sliderPosition"))return this.state.sliderPosition;var e=this.props.scale,t=K.indexOf(e);return-1===t?0:Math.floor(99*t/(K.length-1))}},{key:"render",value:function(){var e=this.props,t=e.translate,n=e.scale;return h.a.createElement("div",{className:"media-library__scale"},h.a.createElement(W.a,{className:"media-library__scale-toggle",compact:!0},h.a.createElement(G.a,{selected:1!==n,onClick:this.setScaleToMobileGrid},h.a.createElement("span",{className:"media-library__scale-toggle-label"},t("Grid")),h.a.createElement(I.a,{icon:"grid",size:18})),h.a.createElement(G.a,{selected:1===n,onClick:this.setScaleToMobileFull},h.a.createElement("span",{className:"media-library__scale-toggle-label"},t("List")),h.a.createElement(I.a,{icon:"menu",size:18}))),h.a.createElement(B.a,{step:"1",min:"0",max:99,minContent:h.a.createElement(I.a,{icon:"image",size:12}),maxContent:h.a.createElement(I.a,{icon:"image",size:24}),value:this.getSliderPosition(),onChange:this.onScaleChange,className:"media-library__scale-range"}))}}]),t}(m.Component);Z.propTypes={mediaScale:y.a.number,onChange:y.a.func,setMediaScalePreference:y.a.func,saveMediaScalePreference:y.a.func},Z.defaultProps={onChange:function(){}};var J=Object(j.b)(function(e){return{scale:Object(Y.b)(e,"mediaScale")}},{setMediaScalePreference:Object(g.partial)(H.c,"mediaScale"),saveMediaScalePreference:Object(g.partial)(H.b,"mediaScale")})(Object(E.localize)(Z)),X=n("./client/my-sites/media-library/upload-button.jsx"),$=n("./client/components/forms/form-text-input/index.jsx"),ee=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.state={value:"",isError:!1},n.upload=function(e){e.preventDefault();var t=!e.target.checkValidity();n.setState({isError:t}),!t&&n.props.site&&(P.a.clearValidationErrors(n.props.site.ID),P.a.add(n.props.site,n.state.value),n.setState({value:"",isError:!1}),n.props.onAddMedia(),n.props.onClose(),C.default.mc.bumpStat("editor_upload_via","url"))},n.onChange=function(e){n.setState({isError:!1,value:e.target.value})},n.onKeyDown=function(e){if("Escape"===e.key)return n.props.onClose(e);"Enter"===e.key&&n.upload(e)},n}return p()(t,e),r()(t,[{key:"render",value:function(){var e=f()("media-library__upload-url",this.props.className),t=this.props,n=t.onClose,s=t.translate;return h.a.createElement("form",{className:e,onSubmit:this.upload,noValidate:!0},h.a.createElement($.a,{type:"url",value:this.state.value,placeholder:"https://",onChange:this.onChange,onKeyDown:this.onKeyDown,isError:this.state.isError,autoFocus:!0,required:!0}),h.a.createElement("div",{className:"media-library__upload-url-button-group"},h.a.createElement("button",{type:"submit",className:"button is-primary"},s("Upload",{context:"verb"})),h.a.createElement("button",{type:"button",className:"media-library__upload-url-cancel",onClick:n},h.a.createElement("span",{className:"screen-reader-text"},s("Cancel")),h.a.createElement(I.a,{icon:"cross"}))))}}]),t}(m.Component);ee.propTypes={className:y.a.string,site:y.a.object,onAddMedia:y.a.func,onClose:y.a.func},ee.defaultProps={onAddMedia:g.noop,onClose:g.noop};var te=Object(E.localize)(ee),ne=n("./client/lib/site/utils.js"),se=n("./node_modules/@babel/runtime/helpers/extends.js"),ae=n.n(se),ie=n("./client/lib/media/utils.js"),re=n("./client/state/current-user/selectors.js"),oe=n("./client/state/ui/media-modal/selectors.js"),le=n("./client/state/ui/editor/actions.js"),ce=n("./client/state/ui/media-modal/constants.js"),de=n("./client/state/analytics/actions.js"),ue=n("./client/components/button/index.jsx"),pe=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"getButtons",value:function(){var e=this.props,t=e.disabled,n=e.selectedItems,s=e.site,a=e.translate,i=e.user,r=e.view,o=e.onDelete,l=e.onViewDetails,c=[];ce.a.LIST===r&&n.length&&c.push({key:"edit",text:a("Edit"),disabled:t,primary:!0,onClick:l});var d=n.length&&Object(g.every)(n,function(e){return Object(ie.a)(e,i,s)});if(ce.a.GALLERY!==r&&d){var u=t||Object(g.some)(n,"transient");c.push({key:"delete",icon:"trash",className:"editor-media-modal__delete",disabled:u,onClick:u?g.noop:o})}return c}},{key:"render",value:function(){return h.a.createElement("div",null,this.getButtons().map(function(e){return h.a.createElement(ue.a,ae()({className:f()("editor-media-modal__secondary-action",e.className),"data-e2e-button":e.key,compact:!0},Object(g.pick)(e,["key","disabled","onClick","primary"])),e.icon&&h.a.createElement(I.a,{icon:e.icon}),e.text&&e.text)}))}}]),t}(m.Component);pe.propTypes={user:y.a.object,site:y.a.object,selectedItems:y.a.array,view:y.a.oneOf(Object(g.values)(ce.a)),disabled:y.a.bool,onDelete:y.a.func,onViewDetails:y.a.func},pe.defaultProps={disabled:!1,onDelete:g.noop};var me=Object(j.b)(function(e,t){return{view:Object(oe.a)(e),user:Object(re.b)(e),siteSlug:t.site?Object(U.w)(e,t.site.ID):""}},{onViewDetails:Object(g.flow)(Object(de.k)(Object(de.a)("editor_media_actions","edit_button_dialog")),Object(de.k)(Object(de.g)("Media","Clicked Dialog Edit Button")),Object(g.partial)(le.l,ce.a.DETAIL))},function(e,t,n){return Object.assign({},n,e,t,Object(g.pick)(n,["onViewDetails","view"]))})(Object(E.localize)(pe)),he=n("./client/components/card/index.jsx"),be=n("./client/components/button-group/index.jsx"),fe=n("./client/components/sticky-panel/index.jsx"),ge=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.state={addingViaUrl:!1,isMoreOptionsVisible:!1},n.setMoreOptionsContext=function(e){e&&n.setState({moreOptionsContext:e})},n.toggleAddViaUrl=function(e){n.setState({addingViaUrl:e,isMoreOptionsVisible:!1})},n.toggleMoreOptions=function(e){n.setState({isMoreOptionsVisible:e})},n.renderUploadButtons=function(){var e=n.props,t=e.site,s=e.filter,a=e.onAddMedia;if(Object(ne.g)("upload_files",t))return h.a.createElement(be.a,{className:"media-library__upload-buttons"},h.a.createElement(X.a,{site:t,filter:s,onAddMedia:a,className:"button is-compact"},h.a.createElement(I.a,{icon:"add-image"}),h.a.createElement("span",{className:"is-desktop"},n.props.translate("Add New",{context:"Media upload"}))),h.a.createElement(ue.a,{compact:!0,ref:n.setMoreOptionsContext,onClick:n.toggleMoreOptions.bind(F()(F()(n)),!n.state.isMoreOptionsVisible),className:"button media-library__upload-more","data-tip-target":"media-library-upload-more"},h.a.createElement("span",{className:"screen-reader-text"},n.props.translate("More Options")),h.a.createElement(I.a,{icon:"chevron-down",size:20}),h.a.createElement(q.a,{context:n.state.moreOptionsContext,isVisible:n.state.isMoreOptionsVisible,onClose:n.toggleMoreOptions.bind(F()(F()(n)),!1),position:"bottom right",className:"is-dialog-visible media-library__header-popover"},h.a.createElement(z.a,{onClick:n.toggleAddViaUrl.bind(F()(F()(n)),!0)},n.props.translate("Add via URL",{context:"Media upload"})))))},n}return p()(t,e),r()(t,[{key:"render",value:function(){var e=this.props,t=e.site,n=e.onAddMedia;if(this.state.addingViaUrl)return h.a.createElement(te,{site:t,onAddMedia:n,onClose:this.toggleAddViaUrl.bind(this,!1),className:"media-library__header"});var s=h.a.createElement(he.a,{className:"media-library__header"},this.renderUploadButtons(),h.a.createElement(me,{selectedItems:this.props.selectedItems,onViewDetails:this.props.onViewDetails,onDelete:this.props.onDeleteItem,site:this.props.site,view:"LIST"}),h.a.createElement(J,{onChange:this.props.onMediaScaleChange}));return this.props.sticky?h.a.createElement(fe.a,{minLimit:660},s):s}}]),t}(h.a.Component);ge.displayName="MediaLibraryHeader",ge.propTypes={site:y.a.object,filter:y.a.string,sliderPositionCount:y.a.number,onMediaScaleChange:y.a.func,onAddMedia:y.a.func,sticky:y.a.bool},ge.defaultProps={onAddMedia:function(){},sliderPositionCount:100,sticky:!1};var ve=Object(E.localize)(ge),ye=250,je=function(e){function t(e){var n;return a()(this,t),n=l()(this,d()(t).call(this,e)),n.onCopy=function(){var e=n.props,t=e.site,s=e.selectedItems,a=e.source,i=e.onSourceChange;i("",function(){P.a.addExternal(t,s,a)})},n.handleClick=n.onClick.bind(F()(F()(n))),n.handleMedia=n.onUpdateState.bind(F()(F()(n))),n.handleFetchOn=n.onSetFetch.bind(F()(F()(n))),n.handleFetchOff=Object(g.debounce)(n.onDisableFetch.bind(F()(F()(n))),ye),n.state=n.getState(),n}return p()(t,e),r()(t,[{key:"onSetFetch",value:function(){this.handleFetchOff.cancel(),this.setState({fetching:!0})}},{key:"onDisableFetch",value:function(){this.setState({fetching:!1})}},{key:"componentDidMount",value:function(){w.a.on("change",this.handleMedia)}},{key:"componentWillUnmount",value:function(){this.handleFetchOff.cancel(),w.a.off("change",this.handleMedia)}},{key:"onUpdateState",value:function(){var e=this.getState(),t=e.fetching;t?this.handleFetchOn():this.handleFetchOff()}},{key:"getState",value:function(){return{fetching:w.a.isFetchingNextPage(this.props.site.ID)}}},{key:"onClick",value:function(){var e=this.props.site.ID;P.a.sourceChanged(e),P.a.fetchNextPage(e)}},{key:"renderCopyButton",value:function(){var e=this.props,t=e.selectedItems,n=e.translate;return h.a.createElement(ue.a,{compact:!0,disabled:0===t.length,onClick:this.onCopy,primary:!0},n("Copy to media library"))}},{key:"renderPexelsAttribution",value:function(){var e=this.props.translate,t=e("Photos provided by {{a}}Pexels{{/a}}",{components:{a:h.a.createElement("a",{href:"https://www.pexels.com/",rel:"noopener noreferrer",target:"_blank"})}});return h.a.createElement("span",{className:"media-library__pexels-attribution"},t)}},{key:"renderCard",value:function(){var e=this.props,t=e.onMediaScaleChange,n=e.translate,s=e.canCopy,a=e.hasRefreshButton,i=e.hasAttribution;return h.a.createElement(he.a,{className:"media-library__header"},i&&this.renderPexelsAttribution(),a&&h.a.createElement(ue.a,{compact:!0,disabled:this.state.fetching,onClick:this.handleClick},h.a.createElement(I.a,{icon:"refresh",size:24}),n("Refresh")),s&&this.renderCopyButton(),h.a.createElement(J,{onChange:t}))}},{key:"render",value:function(){var e=this.props.visible;return e?this.props.sticky?h.a.createElement(fe.a,{minLimit:660},this.renderCard()):this.renderCard():null}}]),t}(h.a.Component);je.propTypes={onMediaScaleChange:y.a.func,site:y.a.object.isRequired,visible:y.a.bool.isRequired,canCopy:y.a.bool,selectedItems:y.a.array,onSourceChange:y.a.func,sticky:y.a.bool,hasAttribution:y.a.bool,hasRefreshButton:y.a.bool};var _e=Object(E.localize)(je),xe=n("./node_modules/react-dom/index.js"),Ee=n.n(xe),ke=n("./client/my-sites/media-library/list-item.jsx"),Ie=n("./client/my-sites/no-results/index.jsx"),Ce=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.getLabel=function(){var e;switch(n.props.filter){case"images":e=n.props.translate("No images match your search for {{searchTerm/}}.",{components:{searchTerm:h.a.createElement("em",null,n.props.search)},context:"Media no search results"});break;case"videos":e=n.props.translate("No videos match your search for {{searchTerm/}}.",{components:{searchTerm:h.a.createElement("em",null,n.props.search)},context:"Media no search results"});break;case"audio":e=n.props.translate("No audio files match your search for {{searchTerm/}}.",{components:{searchTerm:h.a.createElement("em",null,n.props.search)},context:"Media no search results"});break;case"documents":e=n.props.translate("No documents match your search for {{searchTerm/}}.",{components:{searchTerm:h.a.createElement("em",null,n.props.search)},context:"Media no search results"});break;default:e=n.props.translate("No media files match your search for {{searchTerm/}}.",{components:{searchTerm:h.a.createElement("em",null,n.props.search)},context:"Media no search results"})}return e},n}return p()(t,e),r()(t,[{key:"render",value:function(){return h.a.createElement(Ie.a,{text:this.getLabel(),image:"/calypso/images/pages/illustration-pages.svg"})}}]),t}(h.a.Component);Ce.displayName="MediaLibraryListNoResults",Ce.propTypes={filter:y.a.string,search:y.a.string},Ce.defaultProps={search:""};var Se=Object(E.localize)(Ce),Oe=n("./client/components/empty-content/index.jsx"),Ne=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"getLabel",value:function(){var e=this.props,t=e.filter,n=e.source,s=e.translate;if("google_photos"===n)return s("You don't have any photos in your Google library.",{comment:"Media no results"});if("pexels"===n)return s("Use the search above to find free photos!",{comment:"Media no results"});switch(t){case"this-post":return s("There are no media items uploaded to this post.",{comment:"Media no results"});case"images":return s("You don't have any images.",{comment:"Media no results"});case"videos":return s("You don't have any videos.",{comment:"Media no results"});case"audio":return s("You don't have any audio files.",{comment:"Media no results"});case"documents":return s("You don't have any documents.",{comment:"Media no results"});default:return s("You don't have any media.",{comment:"Media no results"})}}},{key:"render",value:function(){var e="",t="";return Object(ne.g)("upload_files",this.props.site)&&!this.props.source?(e=this.props.translate("Would you like to upload something?"),t=h.a.createElement(X.a,{className:"button is-primary",site:this.props.site},this.props.translate("Upload Media"))):"google_photos"===this.props.source&&(e=this.props.translate("New photos may take a few minutes to appear.")),h.a.createElement(Oe.a,{title:this.getLabel(),line:e,action:t,illustration:"/calypso/images/media/illustration-media.svg",illustrationWidth:150})}}]),t}(m.Component);Ne.propTypes={site:y.a.object,filter:y.a.string,source:y.a.string};var Pe=Object(E.localize)(Ne),we=n("./node_modules/@babel/runtime/helpers/toConsumableArray.js"),Me=n.n(we),De=n("./client/components/infinite-list/index.jsx"),Te=function(e){var t=e.itemsCount,n=e.itemsPerRow,s=e.lastInRow,a=e.scale,i=e.text,r=1%a/(n-1)*100||0,o={marginRight:(s?0:r)+"%",width:a*t*100+r*(t-1)+"%"};return h.a.createElement("div",{className:"sorted-grid__label",style:o},i)};Te.propTypes={itemsCount:y.a.number,itemsPerRow:y.a.number,lastInRow:y.a.bool,scale:y.a.number.isRequired,text:y.a.string},Te.defaultProps={text:""};var Re=Object(j.b)(function(e){return{scale:Object(Y.b)(e,"mediaScale")}},null,null,{pure:!1}),Le=Re(Te),Ae=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.renderItem=function(e){return e.isGridLabel?n.renderLabels(e):n.props.renderItem(e)},n}return p()(t,e),r()(t,[{key:"getItems",value:function(){for(var e=[],t=0;t<this.props.items.length;t+=this.props.itemsPerRow){var n=Object(g.slice)(this.props.items,t,t+this.props.itemsPerRow),s=Object(g.reduce)(Object(g.map)(n,this.props.getItemGroup),function(e,t){return e[t]=Object(g.get)(e,t,0)+1,e},{});e.push.apply(e,[{isGridLabel:!0,id:t,groups:s}].concat(Me()(n)))}return e}},{key:"renderLabels",value:function(e){var t=this;return h.a.createElement("div",{key:"header_"+e.id,className:"sorted-grid__header"},Object(g.map)(e.groups,function(n,s){var a=t.props.getGroupLabel(s);return""!==a&&h.a.createElement(Le,{key:"group_"+s,text:t.props.getGroupLabel(s),itemsCount:n,itemsPerRow:t.props.itemsPerRow,lastInRow:Object(g.last)(Object(g.keys)(e.groups))===s})}))}},{key:"render",value:function(){var e=Object(g.omit)(this.props,"getGroupLabel","getItemGroup","items","renderItem");return h.a.createElement(De.a,ae()({items:this.getItems(),renderItem:this.renderItem},e))}}]),t}(m.PureComponent);Ae.propTypes={getGroupLabel:y.a.func.isRequired,getItemGroup:y.a.func.isRequired,items:y.a.array,itemsPerRow:y.a.number.isRequired};var Ue=Ae,Ve=n("./client/lib/plans/constants.js"),Fe=n("./client/my-sites/upgrade-nudge/index.jsx"),qe=n("./client/lib/formatting/index.js"),ze=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.getTitle=function(){switch(n.props.filter){case"videos":return n.props.translate("Upload Videos",{textOnly:!0,context:"Media upload plan needed"});case"audio":return n.props.translate("Upload Audio",{textOnly:!0,context:"Media upload plan needed"});default:return n.props.translate("Upload Media",{textOnly:!0,context:"Media upload plan needed"})}},n.getSummary=function(){switch(n.props.filter){case"videos":return Object(qe.d)(n.props.translate("To upload video files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}),2);case"audio":return Object(qe.d)(n.props.translate("To upload audio files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}),2);default:return Object(qe.d)(n.props.translate("To upload audio and video files to your site, upgrade your plan.",{textOnly:!0,context:"Media upgrade promo"}),2)}},n.viewPlansPage=function(){var e=n.props.site.slug,t=void 0===e?"":e;C.default.tracks.recordEvent("calypso_media_plans_button_click"),x()("/plans/"+t)},n}return p()(t,e),r()(t,[{key:"render",value:function(){var e=h.a.createElement(ue.a,{className:"button is-primary",onClick:this.viewPlansPage},this.props.translate("See Plans"));return h.a.createElement(Oe.a,{title:this.getTitle(),line:this.getSummary(),action:this.props.children||e,illustration:""})}}]),t}(h.a.Component);ze.displayName="MediaLibraryListPlanPromo",ze.propTypes={site:y.a.object,filter:y.a.string};var Be=Object(E.localize)(ze);var We=function(e){var t=e.translate,n=e.filter,s=e.site;return h.a.createElement("div",{className:"media-library__videopress-nudge-container"},h.a.createElement(Be,{site:s,filter:n},h.a.createElement(Fe.a,{className:"media-library__videopress-nudge-regular",title:function(e,t){return t("audio"===e?"Upgrade to the Premium Plan and Enable Audio Uploads":"Upgrade to a Premium Plan and Enable VideoPress")}(n,t),message:function(e,t){return t("audio"===e?"By upgrading to the Premium plan you'll enable audio upload support on your site.":"By upgrading to a Premium Plan you'll enable VideoPress support on your site.")}(n,t),feature:"audio"===n?Ve.c:Ve.z,event:"calypso_media_uploads_upgrade_nudge"})))};We.propTypes={site:y.a.object,translate:y.a.func,filter:y.a.string},We.defaultProps={translate:g.identity,filter:"video"};var Ge=Object(E.localize)(We),He=n("./client/state/selectors/is-rtl.js"),Ye=1e3,Ke=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.state={},n.setListContext=function(e){e&&n.setState({listContext:Ee.a.findDOMNode(e)})},n.getMediaItemHeight=function(){return Math.round(n.props.containerWidth*n.props.mediaScale)+n.props.rowPadding},n.getItemsPerRow=function(){return Math.floor(1/n.props.mediaScale)},n.getMediaItemStyle=function(e){var t=n.getItemsPerRow(),s=t===1/n.props.mediaScale,a=0==(e+1)%t,i={paddingBottom:n.props.rowPadding,fontSize:225*n.props.mediaScale};if(!s&&!a){var r=1%n.props.mediaScale/(t-1)*100+"%",o=n.props.isRtl;o?i.marginLeft=r:i.marginRight=r}return i},n.toggleItem=function(e,t){var s;s=n.props.single?Object(g.filter)(n.props.mediaLibrarySelectedItems,{ID:e.ID}):Object(g.clone)(n.props.mediaLibrarySelectedItems);var a=Object(g.findIndex)(s,{ID:e.ID}),i=-1===a,r=Object(g.findIndex)(n.props.media,{ID:e.ID}),o=r,l=r;!n.props.single&&t&&(o=Math.min(o,n.state.lastSelectedMediaIndex),l=Math.max(l,n.state.lastSelectedMediaIndex));for(var c=o;c<=l;c++){var d=Object(g.findIndex)(s,{ID:n.props.media[c].ID});i&&-1===d?s.push(n.props.media[c]):i||-1===d||s.splice(d,1)}n.setState({lastSelectedMediaIndex:r}),n.props.site&&P.a.setLibrarySelectedItems(n.props.site.ID,s)},n.getItemRef=function(e){return"item-"+e.ID},n.getGroupLabel=function(e){var t=new Date(e),n=new Date;return t.getFullYear()===n.getFullYear()?Object(E.moment)(e).format("MMM D"):Object(E.moment)(e).format("MMM D, YYYY")},n.getItemGroup=function(e){return Object(g.min)([e.date.slice(0,10),Object(E.moment)(new Date).format("YYYY-MM-DD")])},n.renderItem=function(e){var t=Object(g.findIndex)(n.props.media,{ID:e.ID}),s=n.props.mediaLibrarySelectedItems,a=Object(g.findIndex)(s,{ID:e.ID}),i=n.getItemRef(e),r=!n.props.single&&-1!==a&&1===s.length&&"image"===Object(ie.g)(e);return h.a.createElement(ke.a,{ref:i,key:i,style:n.getMediaItemStyle(t),media:e,scale:n.props.mediaScale,thumbnailType:n.props.thumbnailType,showGalleryHelp:r,selectedIndex:a,onToggle:n.toggleItem,onEditItem:n.props.onEditItem})},n.renderLoadingPlaceholders=function(){var e=n.getItemsPerRow(),t=(n.props.media||[]).length,s=e-t%e;return Array.apply(null,new Array(s)).map(function(e,n){return h.a.createElement(ke.a,{key:"placeholder-"+n,style:this.getMediaItemStyle(t+n),scale:this.props.mediaScale})},F()(F()(n)))},n.renderTrailingItems=function(){var e=n.props,t=e.media,s=e.source;if("google_photos"===s&&t&&t.length>=Ye){var a=Object(E.translate)("Use the search button to access more photos. You can search for dates, locations, and things.");return h.a.createElement("p",null,h.a.createElement("em",null,a))}return null},n}return p()(t,e),r()(t,[{key:"sourceIsUngrouped",value:function(e){return-1!==["pexels"].indexOf(e)}},{key:"render",value:function(){var e=this,t=this.getItemGroup,n=this.getGroupLabel;if(this.props.filterRequiresUpgrade)return h.a.createElement(Ge,{filter:this.props.filter,site:this.props.site});if(!this.props.mediaHasNextPage&&this.props.media&&0===this.props.media.length)return h.a.createElement(this.props.search?Se:Pe,{site:this.props.site,filter:this.props.filter,search:this.props.search,source:this.props.source});var s=function(){this.props.mediaOnFetchNextPage()}.bind(this);return this.sourceIsUngrouped(this.props.source)&&(t=function(){return e.props.source},n=function(){return""}),h.a.createElement(Ue,{ref:this.setListContext,getItemGroup:t,getGroupLabel:n,context:!!this.props.scrollable&&this.state.listContext,items:this.props.media||[],itemsPerRow:this.getItemsPerRow(),lastPage:!this.props.mediaHasNextPage,fetchingNextPage:this.props.mediaFetchingNextPage,guessedItemHeight:this.getMediaItemHeight(),fetchNextPage:s,getItemRef:this.getItemRef,renderItem:this.renderItem,renderLoadingPlaceholders:this.renderLoadingPlaceholders,renderTrailingItems:this.renderTrailingItems,className:"media-library__list"})}}]),t}(h.a.Component);Ke.displayName="MediaLibraryList",Ke.propTypes={site:y.a.object,media:y.a.arrayOf(y.a.object),mediaLibrarySelectedItems:y.a.arrayOf(y.a.object),filter:y.a.string,filterRequiresUpgrade:y.a.bool.isRequired,search:y.a.string,containerWidth:y.a.number,rowPadding:y.a.number,mediaScale:y.a.number.isRequired,thumbnailType:y.a.string,mediaHasNextPage:y.a.bool,mediaFetchingNextPage:y.a.bool,mediaOnFetchNextPage:y.a.func,single:y.a.bool,scrollable:y.a.bool,onEditItem:y.a.func},Ke.defaultProps={mediaLibrarySelectedItems:Object.freeze([]),containerWidth:0,rowPadding:10,mediaHasNextPage:!1,mediaFetchingNextPage:!1,mediaOnFetchNextPage:g.noop,single:!1,scrollable:!1,onEditItem:g.noop};var Qe=Object(j.b)(function(e){return{mediaScale:Object(Y.b)(e,"mediaScale"),isRtl:Object(He.a)(e)}},null,null,{pure:!1})(Ke),Ze=n("./client/state/sharing/services/selectors.js"),Je=n("./client/components/data/query-keyring-services/index.jsx"),Xe=n("./client/components/data/query-publicize-connections/index.jsx"),$e=n("./client/my-sites/sharing/connections/service-action.jsx"),et=n("./client/state/sharing/keyring/actions.js"),tt=n("./client/state/sharing/keyring/selectors.js"),nt=n("./client/lib/sharing/index.js"),st=function(e){function t(e){var n;return a()(this,t),n=l()(this,d()(t).call(this,e)),n.handleAction=n.onAction.bind(F()(F()(n))),n.state={isConnecting:!1,isRefreshing:!1},n}return p()(t,e),r()(t,[{key:"getConnectionStatus",value:function(e,t){return t?"unknown":e?"broken"===e.status?"reconnect":"connected":"not-connected"}},{key:"onAction",value:function(){var e=this.props.service,t=this.getConnectionStatus(this.props.connectedService,this.state.isFetching);"reconnect"===t?this.refresh(e):this.addConnection(e)}},{key:"refresh",value:function(e){this.setState({isRefreshing:!0}),this.requestAccess(e.refresh_URL),this.trackEvent(e.ID,"Clicked Connect Button")}},{key:"addConnection",value:function(e){this.setState({isConnecting:!0}),this.requestAccess(e.connect_URL),this.trackEvent(e.ID,"Clicked Reconnect Button")}},{key:"requestAccess",value:function(e){var t=this;Object(nt.a)(e,function(){t.props.requestKeyringConnections()})}},{key:"trackEvent",value:function(e,t){this.props.recordGoogleEvent("Sharing",t,e)}},{key:"componentWillReceiveProps",value:function(e){!0===e.isFetching&&this.setState({isConnecting:!1,isRefreshing:!1})}},{key:"render",value:function(){var e=this.getConnectionStatus(this.props.connectedService,this.props.isFetching),t=this.state,n=t.isConnecting,s=t.isRefreshing,a=this.props.service;return h.a.createElement($e.a,{status:e,service:a,onAction:this.handleAction,isConnecting:n,isRefreshing:s,isDisconnecting:!1})}}]),t}(m.Component);st.propTypes={service:y.a.object.isRequired,isFetching:y.a.bool.isRequired,connectedService:y.a.object};var at=Object(j.b)(function(e,t){var n=function(e,t){return Object(tt.b)(e).filter(function(e){return e.service===t})}(e,t.serviceName);return{isFetching:Object(tt.d)(e),connectedService:n.length>0?n[0]:null}},{requestKeyringConnections:et.c,recordGoogleEvent:de.g})(st),it=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){var e=this.props.service;return h.a.createElement("div",null,h.a.createElement(Xe.a,{selectedSite:!0}),h.a.createElement(Je.a,null),e&&h.a.createElement(at,{service:e}))}}]),t}(m.Component);it.propTypes={serviceName:y.a.string.isRequired};var rt=Object(j.b)(function(e,t){return{service:Object(Ze.b)(e,t.serviceName)}})(it),ot=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.retryList=function(){P.a.sourceChanged(n.props.site.ID)},n.goToSharing=function(e){e.preventDefault(),x()("/sharing/"+n.props.site.slug)},n}return p()(t,e),r()(t,[{key:"renderErrors",value:function(){var e=this,t=Object(g.values)(this.props.mediaValidationErrors).map(g.head);return Object(g.map)(Object(g.groupBy)(t),function(t,n){var s,a,i={count:t.length,args:t.length};e.props.site&&(a=P.a.clearValidationErrorsByType.bind(null,e.props.site.ID,n));var r="is-error",o=void 0,l=void 0,c=!1;switch(n){case A.i.FILE_TYPE_NOT_IN_PLAN:r="is-warning",o="plan-media-storage-error-video",l="video-upload",s=e.props.translate("%d file could not be uploaded because your site does not support video files. Upgrade to a premium plan for video support.","%d files could not be uploaded because your site does not support video files. Upgrade to a premium plan for video support.",i);break;case A.i.FILE_TYPE_UNSUPPORTED:s=e.props.translate("%d file could not be uploaded because the file type is not supported.","%d files could not be uploaded because their file types are unsupported.",i);break;case A.i.UPLOAD_VIA_URL_404:s=e.props.translate("%d file could not be uploaded because no image exists at the specified URL.","%d files could not be uploaded because no images exist at the specified URLs",i);break;case A.i.EXCEEDS_MAX_UPLOAD_SIZE:s=e.props.translate("%d file could not be uploaded because it exceeds the maximum upload size.","%d files could not be uploaded because they exceed the maximum upload size.",i);break;case A.i.NOT_ENOUGH_SPACE:o="plan-media-storage-error",l="extra-storage",s=e.props.translate("%d file could not be uploaded because there is not enough space left.","%d files could not be uploaded because there is not enough space left.",i);break;case A.i.EXCEEDS_PLAN_STORAGE_LIMIT:o="plan-media-storage-error",l="extra-storage",s=e.props.translate("%d file could not be uploaded because you have reached your plan storage limit.","%d files could not be uploaded because you have reached your plan storage limit.",i);break;case A.i.SERVICE_FAILED:s=e.props.translate("We are unable to retrieve your full media library."),c=!0;break;default:s=e.props.translate("%d file could not be uploaded because an error occurred while uploading.","%d files could not be uploaded because errors occurred while uploading.",i)}return h.a.createElement(O.b,{key:n,status:r,text:s,onDismissClick:a},e.renderNoticeAction(o,l),c&&e.renderTryAgain())})}},{key:"renderTryAgain",value:function(){return h.a.createElement(N.a,{onClick:this.retryList},this.props.translate("Retry"))}},{key:"renderNoticeAction",value:function(e,t){if(!e)return null;var n={cta_name:e,cta_feature:t};return h.a.createElement(N.a,{external:!0,href:t?"/plans/compare/"+this.props.siteSlug+"?feature="+t:"/plans/"+this.props.siteSlug,onClick:this.recordPlansNavigation.bind(this,"calypso_upgrade_nudge_cta_click",n)},this.props.translate("Upgrade Plan"),h.a.createElement(S.a,{eventName:"calypso_upgrade_nudge_impression",eventProperties:n}))}},{key:"recordPlansNavigation",value:function(e,t){C.default.ga.recordEvent("Media","Clicked Upload Error Action"),C.default.tracks.recordEvent(e,t)}},{key:"renderGooglePhotosConnect",value:function(){var e=this.props.translate("To show Photos from Google, you need to connect your Google account.");return h.a.createElement("div",{className:"media-library__connect-message"},h.a.createElement("p",null,h.a.createElement(I.a,{icon:"image",size:72})),h.a.createElement("p",null,e),h.a.createElement(rt,{serviceName:"google_photos"}))}},{key:"renderConnectExternalMedia",value:function(){var e=this.props.source;switch(e){case"google_photos":return this.renderGooglePhotosConnect()}return null}},{key:"getThumbnailType",value:function(){return""!==this.props.source?A.f:this.props.site.is_private?A.e:A.d}},{key:"needsToBeConnected",value:function(){return""!==this.props.source&&!this.props.isConnected}},{key:"renderMediaList",value:function(){return!this.props.site||this.props.isRequesting&&!this.hasRequested?(this.hasRequested=!0,h.a.createElement(Qe,{key:"list-loading",filterRequiresUpgrade:this.props.filterRequiresUpgrade})):this.needsToBeConnected()?this.renderConnectExternalMedia():h.a.createElement(R,{siteId:this.props.site.ID,postId:this.props.postId,filter:this.props.filter,search:this.props.search,source:this.props.source},h.a.createElement(L.a,{siteId:this.props.site.ID},h.a.createElement(Qe,{key:"list-"+[this.props.site.ID,this.props.search,this.props.filter].join(),site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.props.filterRequiresUpgrade,search:this.props.search,containerWidth:this.props.containerWidth,thumbnailType:this.getThumbnailType(),single:this.props.single,scrollable:this.props.scrollable,onEditItem:this.props.onEditItem})))}},{key:"renderHeader",value:function(){return!this.props.isConnected&&this.needsToBeConnected()?null:""!==this.props.source?h.a.createElement(_e,{onMediaScaleChange:this.props.onMediaScaleChange,site:this.props.site,visible:!this.props.isRequesting,canCopy:void 0===this.props.postId,source:this.props.source,onSourceChange:this.props.onSourceChange,selectedItems:this.props.selectedItems,sticky:!this.props.scrollable,hasAttribution:"pexels"===this.props.source,hasRefreshButton:"pexels"!==this.props.source}):this.props.filterRequiresUpgrade?null:h.a.createElement(ve,{site:this.props.site,filter:this.props.filter,onMediaScaleChange:this.props.onMediaScaleChange,onAddMedia:this.props.onAddMedia,onAddAndEditImage:this.props.onAddAndEditImage,selectedItems:this.props.selectedItems,onViewDetails:this.props.onViewDetails,onDeleteItem:this.props.onDeleteItem,sticky:!this.props.scrollable})}},{key:"render",value:function(){return h.a.createElement("div",{className:"media-library__content"},this.renderHeader(),this.renderErrors(),this.renderMediaList())}}]),t}(h.a.Component);ot.propTypes={site:y.a.object,mediaValidationErrors:y.a.object,filter:y.a.string,filterRequiresUpgrade:y.a.bool,search:y.a.string,source:y.a.string,containerWidth:y.a.number,single:y.a.bool,scrollable:y.a.bool,onAddMedia:y.a.func,onMediaScaleChange:y.a.func,onEditItem:y.a.func,postId:y.a.number,isConnected:y.a.bool},ot.defaultProps={mediaValidationErrors:Object.freeze({}),onAddMedia:g.noop,source:""};var lt=Object(j.b)(function(e,t){return{siteSlug:t.site?Object(U.w)(e,t.site.ID):"",isRequesting:Object(tt.d)(e)}},null,null,{pure:!1})(Object(E.localize)(ot)),ct=n("./client/my-sites/media-library/drop-zone.jsx"),dt=n("./client/lib/media/library-selected-store.js"),ut=function(e){var t;switch(e){case"images":t="image";break;case"audio":t="audio";break;case"videos":t="video";break;case"documents":t="application"}return t},pt=n("./client/components/section-nav/index.jsx"),mt=n("./client/components/section-nav/tabs.jsx"),ht=n("./client/components/section-nav/item.jsx"),bt=n("./client/components/search/index.jsx"),ft=n("./client/blocks/plan-storage/index.jsx"),gt=n("./client/config/index.js"),vt=function(e){function t(e){var n;return a()(this,t),n=l()(this,d()(t).call(this,e)),n.togglePopover=function(){n.setState({popover:!n.state.popover})},n.changeSource=function(e){var t=e.target,s=t.getAttribute("action")?t.getAttribute("action"):t.parentNode.getAttribute("action"),a=s||"";a!==n.props.source&&n.props.onSourceChange(a)},n.state={popover:!1},n}return p()(t,e),r()(t,[{key:"renderScreenReader",value:function(e){return h.a.createElement("span",{className:"screen-reader-text"},e&&e.label)}},{key:"renderMenuItems",value:function(e){var t=this;return e.filter(function(e){return-1===t.props.disabledSources.indexOf(e.value)}).map(function(e){return h.a.createElement(z.a,{action:e.value,key:e.value,onClick:t.changeSource},e.icon,e.label)})}},{key:"render",value:function(){var e=this.props,t=e.translate,n=e.source,s=[{value:"",label:t("WordPress library"),icon:h.a.createElement(I.a,{icon:"image",size:24})},{value:"google_photos",label:t("Photos from your Google library"),icon:h.a.createElement(I.a,{icon:"shutter",size:24})}];gt.a.isEnabled("external-media/free-photo-library")&&s.push({value:"pexels",label:t("Free photo library"),icon:h.a.createElement(I.a,{icon:"image-multiple",size:24})});var a=Object(g.find)(s,function(e){return e.value===n}),i=f()({button:!0,"media-library__source-button":!0,"is-open":this.state.popover});return gt.a.isEnabled("external-media")?h.a.createElement("div",{className:"media-library__datasource"},h.a.createElement(ue.a,{borderless:!0,ref:"popoverMenuButton",className:i,onClick:this.togglePopover,title:t("Choose media library source")},a&&a.icon,this.renderScreenReader(a),h.a.createElement(I.a,{icon:"chevron-down",size:18}),h.a.createElement(q.a,{context:this.refs&&this.refs.popoverMenuButton,isVisible:this.state.popover,position:"bottom right",onClose:this.togglePopover,className:"is-dialog-visible media-library__header-popover"},this.renderMenuItems(s)))):null}}]),t}(m.Component);vt.propTypes={source:y.a.string.isRequired,onSourceChange:y.a.func.isRequired,disabledSources:y.a.array},vt.defaultProps={disabledSources:[]};var yt=Object(E.localize)(vt),jt=["pexels"],_t=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.changeFilter=function(e){return function(){n.props.onFilterChange(e)}},n}return p()(t,e),r()(t,[{key:"getSearchPlaceholderText",value:function(){var e=this.props,t=e.filter,n=e.source,s=e.translate;if("google_photos"===n)return s("Search your Google library");if("pexels"===n)return s("Search for free photos");switch(t){case"this-post":return s("Search media uploaded to this post");case"images":return s("Search images");case"audio":return s("Search audio files");case"videos":return s("Search videos");case"documents":return s("Search documents");default:return s("Search all media")}}},{key:"getFilterLabel",value:function(e){var t=this.props.translate;switch(e){case"this-post":return t("This Post",{comment:"Filter label for media list"});case"images":return t("Images",{comment:"Filter label for media list"});case"audio":return t("Audio",{comment:"Filter label for media list"});case"videos":return t("Videos",{comment:"Filter label for media list"});case"documents":return t("Documents",{comment:"Filter label for media list"});default:return t("All",{comment:"Filter label for media list"})}}},{key:"isFilterDisabled",value:function(e){var t=this.props.enabledFilters;return t&&(!e.length||!Object(g.includes)(t,e))}},{key:"renderTabItems",value:function(){var e=this;if(""!==this.props.source)return null;var t=["","this-post","images","documents","videos","audio"];return this.props.post||Object(g.pull)(t,"this-post"),h.a.createElement(mt.a,null,t.map(function(t){return h.a.createElement(ht.a,{key:"filter-tab-"+t,selected:e.props.filter===t,onClick:e.changeFilter(t),disabled:e.isFilterDisabled(t)},e.getFilterLabel(t))}))}},{key:"renderSearchSection",value:function(){if(this.props.filterRequiresUpgrade||!this.props.isConnected)return null;var e=""===this.props.source;return h.a.createElement(bt.a,{key:this.props.source,analyticsGroup:"Media",pinned:e,fitsContainer:!0,onSearch:this.props.onSearch,initialValue:this.props.search,placeholder:this.getSearchPlaceholderText(),delaySearch:!0})}},{key:"renderPlanStorage",value:function(){if(this.props.source)return null;return h.a.createElement(ft.a,{siteId:this.props.site.ID},h.a.createElement(S.a,{eventName:"calypso_upgrade_nudge_impression",eventProperties:{cta_name:"plan-media-storage"}}))}},{key:"render",value:function(){var e=this.props.disableLargeImageSources?Object(g.union)(this.props.disabledDataSources,jt):this.props.disabledDataSources;return h.a.createElement("div",{className:"media-library__filter-bar"},h.a.createElement(yt,{source:this.props.source,onSourceChange:this.props.onSourceChange,disabledSources:e}),h.a.createElement(pt.a,{selectedText:this.getFilterLabel(this.props.filter),hasSearch:!0,allowDropdown:!this.props.source},this.renderTabItems(),this.renderSearchSection()),this.renderPlanStorage())}}]),t}(m.Component);_t.propTypes={basePath:y.a.string,enabledFilters:y.a.arrayOf(y.a.string),filter:y.a.string,filterRequiresUpgrade:y.a.bool,search:y.a.string,source:y.a.string,site:y.a.object,onFilterChange:y.a.func,onSearch:y.a.func,translate:y.a.func,post:y.a.bool,isConnected:y.a.bool,disableLargeImageSources:y.a.bool,disabledDataSources:y.a.arrayOf(y.a.string)},_t.defaultProps={filter:"",basePath:"/media",onFilterChange:g.noop,onSourceChange:g.noop,onSearch:g.noop,translate:g.identity,source:"",post:!1,isConnected:!0,disableLargeImageSources:!1,disabledDataSources:[]};var xt=Object(E.localize)(_t),Et=n("./client/lib/media/validation-store.js");function kt(e){return{mediaValidationErrors:Et.a.getAllErrors(e)}}var It=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.state=kt(n.props.siteId),n.updateState=function(){n.setState(kt(n.props.siteId))},n}return p()(t,e),r()(t,[{key:"componentDidMount",value:function(){Et.a.on("change",this.updateState)}},{key:"componentWillUnmount",value:function(){Et.a.off("change",this.updateState)}},{key:"componentWillReceiveProps",value:function(e){this.props.siteId!==e.siteId&&this.setState(kt(e.siteId))}},{key:"render",value:function(){return Object(M.a)(this,this.state)}}]),t}(h.a.Component);It.displayName="MediaValidationData",It.propTypes={siteId:y.a.number.isRequired};var Ct=n("./client/components/data/query-preferences/index.jsx"),St=n("./client/lib/search-url/index.js"),Ot=["pexels"],Nt=function(e){return-1!==Ot.indexOf(e.source)||""===e.source||Object(g.some)(e.connectedServices,function(t){return t.service===e.source})},Pt=function(e){return-1===Ot.indexOf(e.source)&&!e.isRequesting&&""!==e.source&&0===e.connectedServices.length},wt=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.doSearch=function(e){Object(St.a)(e,n.props.search,n.props.onSearch)},n.onAddMedia=function(){var e=dt.a.getAll(n.props.site.ID),t=e;n.props.site&&(n.props.filter&&(t=Object(ie.d)(t,ut(n.props.filter))),n.props.single&&t.length>1&&(t=t.slice(-1)),Object(g.isEqual)(e,t)||P.a.setLibrarySelectedItems(n.props.site.ID,t),n.props.onAddMedia())},n}return p()(t,e),r()(t,[{key:"componentWillMount",value:function(){Pt(this.props)&&this.props.requestKeyringConnections()}},{key:"componentWillReceiveProps",value:function(e){Pt(e)&&""===this.props.source&&this.props.requestKeyringConnections()}},{key:"filterRequiresUpgrade",value:function(){var e=this.props,t=e.filter,n=e.site,s=e.source;if(s)return!1;switch(t){case"audio":return!(n&&n.options.upgraded_filetypes_enabled||n.jetpack);case"videos":return!(n&&n.options.videopress_enabled||n.jetpack)}return!1}},{key:"renderDropZone",value:function(){return""!==this.props.source?null:h.a.createElement(ct.a,{site:this.props.site,filter:this.props.filter,fullScreen:this.props.fullScreenDropZone,onAddMedia:this.onAddMedia})}},{key:"render",value:function(){var e;e=h.a.createElement(lt,{site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.filterRequiresUpgrade(),search:this.props.search,source:this.props.source,isConnected:Nt(this.props),containerWidth:this.props.containerWidth,single:this.props.single,scrollable:this.props.scrollable,onAddMedia:this.onAddMedia,onAddAndEditImage:this.props.onAddAndEditImage,onMediaScaleChange:this.props.onScaleChange,onSourceChange:this.props.onSourceChange,selectedItems:this.props.mediaLibrarySelectedItems,onDeleteItem:this.props.onDeleteItem,onEditItem:this.props.onEditItem,onViewDetails:this.props.onViewDetails,postId:this.props.postId}),this.props.site&&(e=h.a.createElement(It,{siteId:this.props.site.ID},e));var t=f()("media-library",{"is-single":this.props.single},this.props.className);return h.a.createElement("div",{className:t},h.a.createElement(Ct.a,null),this.renderDropZone(),h.a.createElement(xt,{site:this.props.site,filter:this.props.filter,filterRequiresUpgrade:this.filterRequiresUpgrade(),enabledFilters:this.props.enabledFilters,search:this.props.search,onFilterChange:this.props.onFilterChange,onSourceChange:this.props.onSourceChange,source:this.props.source,onSearch:this.doSearch,isConnected:Nt(this.props),post:!!this.props.postId,disableLargeImageSources:this.props.disableLargeImageSources,disabledDataSources:this.props.disabledDataSources}),e)}}]),t}(m.Component);wt.propTypes={className:y.a.string,site:y.a.object,filter:y.a.string,enabledFilters:y.a.arrayOf(y.a.string),search:y.a.string,source:y.a.string,onAddMedia:y.a.func,onFilterChange:y.a.func,onSourceChange:y.a.func,onSearch:y.a.func,onScaleChange:y.a.func,onEditItem:y.a.func,fullScreenDropZone:y.a.bool,containerWidth:y.a.number,single:y.a.bool,scrollable:y.a.bool,postId:y.a.number,disableLargeImageSources:y.a.bool,disabledDataSources:y.a.arrayOf(y.a.string)},wt.defaultProps={fullScreenDropZone:!0,onAddMedia:function(){},onScaleChange:function(){},scrollable:!1,source:"",disableLargeImageSources:!1,disabledDataSources:[]};t.a=Object(j.b)(function(e){return{connectedServices:Object(g.toArray)(Object(tt.b)(e)).filter(function(e){return"other"===e.type&&"ok"===e.status}),isRequesting:Object(tt.d)(e)}},{requestKeyringConnections:et.c})(wt)},"./client/my-sites/media-library/list-item.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/extends.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/createClass.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/inherits.js"),h=n.n(m),b=n("./node_modules/lodash/lodash.js"),f=n("./node_modules/prop-types/index.js"),g=n.n(f),v=n("./node_modules/react/index.js"),y=n.n(v),j=n("./node_modules/classnames/index.js"),_=n.n(j),x=n("./client/components/spinner/index.jsx"),E=n("./node_modules/gridicons/dist/index.js"),k=n.n(E),I=n("./client/lib/media/utils.js"),C=function(e){function t(){return r()(this,t),d()(this,p()(t).apply(this,arguments))}return h()(t,e),l()(t,[{key:"render",value:function(){return y.a.createElement("div",{className:"media-library__list-item-file-details media-library__list-item-centered"},y.a.createElement("div",{className:"media-library__list-item-icon"},y.a.createElement(k.a,{icon:this.props.icon})),y.a.createElement("div",{className:"media-library__list-item-file-name",style:{fontSize:12*(1+this.props.scale)}},this.props.media.title),y.a.createElement("hr",{className:"media-library__list-item-details-separator"}),y.a.createElement("div",{className:"media-library__list-item-file-extension",style:{fontSize:9*(1+this.props.scale)}},(this.props.media.extension||"").toUpperCase()))}}]),t}(y.a.Component);C.displayName="MediaLibraryListItemFileDetails",C.propTypes={media:g.a.object,scale:g.a.number,icon:g.a.string},C.defaultProps={icon:"pages"};var S=n("./client/lib/media/constants.js"),O=function(e){function t(){var e,n;r()(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return n=d()(this,(e=p()(t)).call.apply(e,[this].concat(a))),n.state={},n.getImageDimensions=function(){var e,t;return e=n.props.media.width?n.props.media.width:n.state.imageWidth,t=n.props.media.height?n.props.media.height:n.state.imageHeight,{width:e,height:t}},n.getImageStyle=function(){var e=n.getImageDimensions();return{maxHeight:e.height>e.width?"none":"100%",maxWidth:e.height<e.width?"none":"100%"}},n.setUnknownImageDimensions=function(e){n.props.media.width||n.setState({imageWidth:e.target.clientWidth}),n.props.media.height||n.setState({imageHeight:e.target.clientHeight})},n}return h()(t,e),l()(t,[{key:"render",value:function(){var e=Object(I.s)(this.props.media,{photon:this.props.thumbnailType===S.d,maxWidth:this.props.maxImageWidth,size:this.props.thumbnailType===S.f&&"medium"});return e?y.a.createElement("img",{src:e,onLoad:this.setUnknownImageDimensions,alt:this.props.media.alt||this.props.media.title,style:this.getImageStyle(),className:"media-library__list-item-centered",draggable:"false"}):y.a.createElement(C,{scale:this.props.scale,media:this.props.media,icon:"image"})}}]),t}(y.a.Component);O.displayName="MediaLibraryListItemImage",O.propTypes={media:g.a.object,scale:g.a.number,maxImageWidth:g.a.number,thumbnailType:g.a.string},O.defaultProps={maxImageWidth:450,thumbnailType:S.d};var N=n("./node_modules/photon/index.js"),P=n.n(N),w=function(e){function t(){var e,n;r()(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return n=d()(this,(e=p()(t)).call.apply(e,[this].concat(a))),n.getHighestQualityThumbnail=function(){if(n.props.media.thumbnails)return n.props.media.thumbnails.fmt_hd||n.props.media.thumbnails.fmt_dvd||n.props.media.thumbnails.fmt_std},n}return h()(t,e),l()(t,[{key:"render",value:function(){var e=this.getHighestQualityThumbnail();if(e){var t=this.props.thumbnailType===S.f?e:P()(e,{width:this.props.maxImageWidth});return y.a.createElement("div",{className:"media-library__list-item-video",style:{backgroundImage:"url("+t+")"}},y.a.createElement("span",{className:"media-library__list-item-icon media-library__list-item-centered"},y.a.createElement(k.a,{icon:"video-camera"})))}return y.a.createElement(C,a()({},this.props,{icon:"video-camera"}))}}]),t}(y.a.Component);w.displayName="MediaLibraryListItemVideo",w.propTypes={media:g.a.object,maxImageWidth:g.a.number,thumbnailType:g.a.string},w.defaultProps={maxImageWidth:450,thumbnailType:S.d};var M=function(e){function t(){return r()(this,t),d()(this,p()(t).apply(this,arguments))}return h()(t,e),l()(t,[{key:"render",value:function(){return y.a.createElement(C,a()({},this.props,{icon:"audio"}))}}]),t}(y.a.Component);M.displayName="MediaLibraryListItemDocument";var D=function(e){function t(){return r()(this,t),d()(this,p()(t).apply(this,arguments))}return h()(t,e),l()(t,[{key:"render",value:function(){return y.a.createElement(C,this.props)}}]),t}(y.a.Component);D.displayName="MediaLibraryListItemDocument";var T=n("./node_modules/i18n-calypso/index.js"),R=n("./node_modules/react-redux/es/index.js"),L=n("./node_modules/redux/es/redux.js"),A=n("./client/lib/viewport/index.js"),U=n("./client/components/popover/index.jsx"),V=n("./client/components/forms/form-checkbox/index.jsx"),F=n("./client/components/button/index.jsx"),q=n("./client/state/preferences/actions.js"),z=n("./client/state/preferences/selectors.js"),B=n("./client/state/ui/selectors.js"),W=n("./client/components/data/query-preferences/index.jsx"),G=function(e){function t(){var e,n;r()(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return n=d()(this,(e=p()(t)).call.apply(e,[this].concat(a))),n.state={isDismissed:!1,rememberDismiss:!0},n.setRenderContext=function(e){e&&n.setState({renderContext:e})},n.toggleRememberDismiss=function(){setTimeout(function(){n.setState({rememberDismiss:!n.state.rememberDismiss})},0)},n.dismiss=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.remember;n.setState({isDismissed:!0}),n.props.onDismiss({remember:t})},n.renderPopover=function(){var e=n.state,t=e.renderContext,s=e.isDismissed;if(t&&!s)return y.a.createElement(U.a,{onClose:function(){return n.dismiss()},context:t,position:"bottom",isVisible:!Object(A.c)(),className:"popover__gallery-help is-dialog-visible"},y.a.createElement("div",{className:"editor-media-modal__gallery-help-content"},y.a.createElement("div",{className:"editor-media-modal__gallery-help-instruction"},y.a.createElement("span",{className:"editor-media-modal__gallery-help-icon"},y.a.createElement(k.a,{icon:"image-multiple",size:20})),y.a.createElement("span",{className:"editor-media-modal__gallery-help-text"},n.props.translate("Select more than one image to create a gallery."))),y.a.createElement("div",{className:"editor-media-modal__gallery-help-actions"},y.a.createElement("label",{className:"editor-media-modal__gallery-help-remember-dismiss"},y.a.createElement(V.a,{checked:n.state.rememberDismiss,onChange:n.toggleRememberDismiss}),y.a.createElement("span",null,n.props.translate("Don't show again"))),y.a.createElement(F.a,{onClick:function(){return n.dismiss({remember:n.state.rememberDismiss})},compact:!0},n.props.translate("Got it",{context:"Button label",comment:"User clicks this to confirm that he has understood the text"})))))},n}return h()(t,e),l()(t,[{key:"render",value:function(){return"post-editor"!==this.props.sectionName?null:this.props.isMediaModalGalleryInstructionsDismissed?null:y.a.createElement("div",{ref:this.setRenderContext,className:"editor-media-modal__gallery-help"},y.a.createElement(W.a,null),this.renderPopover())}}]),t}(y.a.PureComponent);G.displayName="EditorMediaModalGalleryHelp",G.propTypes={onDismiss:g.a.func,sectionName:g.a.string},G.defaultProps={onDismiss:function(){}};var H=Object(R.b)(function(e){return{sectionName:Object(B.c)(e),isMediaModalGalleryInstructionsDismissed:Object(z.b)(e,"mediaModalGalleryInstructionsDismissed")||Object(z.b)(e,"mediaModalGalleryInstructionsDismissedForSession")}},function(e){return Object(L.b)({onDismiss:function(e){return e.remember?Object(q.b)("mediaModalGalleryInstructionsDismissed",!0):Object(q.c)("mediaModalGalleryInstructionsDismissedForSession",!0)}},e)})(Object(T.localize)(G));n.d(t,"a",function(){return Y});var Y=function(e){function t(){var e,n;r()(this,t);for(var s=arguments.length,a=new Array(s),i=0;i<s;i++)a[i]=arguments[i];return n=d()(this,(e=p()(t)).call.apply(e,[this].concat(a))),n.clickItem=function(e){n.props.onToggle(n.props.media,e.shiftKey)},n.renderItem=function(){var e;if(n.props.media){switch(Object(I.g)(n.props.media)){case"image":e=O;break;case"video":e=w;break;case"audio":e=M;break;default:e=D}return y.a.createElement(e,n.props)}},n.renderSpinner=function(){if(n.props.media&&n.props.media.transient)return y.a.createElement("div",{className:"media-library__list-item-spinner"},y.a.createElement(x.a,null))},n}return h()(t,e),l()(t,[{key:"shouldComponentUpdate",value:function(e){return!(e.media===this.props.media&&e.scale===this.props.scale&&e.maxImageWidth===this.props.maxImageWidth&&e.thumbnailType===this.props.thumbnailType&&e.selectedIndex===this.props.selectedIndex&&Object(b.isEqual)(e.style,this.props.style))}},{key:"render",value:function(){var e,t,n=_()("media-library__list-item",{"is-placeholder":!this.props.media,"is-selected":-1!==this.props.selectedIndex,"is-transient":this.props.media&&this.props.media.transient,"is-small":this.props.scale<=.125}),s=Object(b.omit)(this.props,Object.keys(this.constructor.propTypes)),i=Object(b.assign)({width:100*this.props.scale+"%"},this.props.style);return this.props.media&&(e=this.props.media.file),-1!==this.props.selectedIndex&&(t=this.props.selectedIndex+1,s["data-selected-number"]=t>99?"99+":t),y.a.createElement("div",a()({className:n,style:i,onClick:this.clickItem},s),y.a.createElement("span",{className:"media-library__list-item-selected-icon"},y.a.createElement(k.a,{icon:"checkmark",size:20})),y.a.createElement("figure",{className:"media-library__list-item-figure",title:e},this.renderItem(),this.renderSpinner(),this.props.showGalleryHelp&&y.a.createElement(H,null)))}}]),t}(y.a.Component);Y.displayName="MediaLibraryListItem",Y.propTypes={media:g.a.object,scale:g.a.number.isRequired,maxImageWidth:g.a.number,thumbnailType:g.a.string,showGalleryHelp:g.a.bool,selectedIndex:g.a.number,onToggle:g.a.func,onEditItem:g.a.func,style:g.a.object},Y.defaultProps={maxImageWidth:450,thumbnailType:S.d,selectedIndex:-1,onToggle:b.noop,onEditItem:b.noop}},"./client/my-sites/no-results/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/react/index.js"),h=n.n(m),b=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){return h.a.createElement("div",{className:"no-results"},this.props.image?h.a.createElement("img",{className:"no-results__img",src:this.props.image}):null,h.a.createElement("span",null,this.props.text))}}]),t}(h.a.Component);b.defaultProps={text:"No results",image:!1},t.a=b},"./client/post-editor/media-modal/detail/detail-preview-video.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/prop-types/index.js"),h=n.n(m),b=n("./node_modules/react/index.js"),f=n.n(b),g=n("./node_modules/classnames/index.js"),v=n.n(g),y=n("./client/lib/media/utils.js"),j=n("./node_modules/lodash/lodash.js"),_=n("./node_modules/debug/src/browser.js"),x=n.n(_),E=n("./client/lib/load-script/index.js"),k=x()("calypso:post-editor:videopress"),I="https://wordpress.com/wp-content/plugins/video/assets/js/next/videopress.js",C=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.setVideoInstance=function(e){return n.video=e},n.onScriptLoaded=function(e){var t=n.props,s=t.isPlaying,a=t.item,i=t.onScriptLoadError;if(e)return k("Script"+Object(j.get)(e,"src","")+" failed to load."),void i();var r=a.height,o=void 0===r?480:r,l=a.videopress_guid,c=a.width,d=void 0===c?854:c;l&&"undefined"!=typeof window&&window.videopress&&(n.player=window.videopress(l,n.video,{autoPlay:s,height:o,width:d}))},n.receiveMessage=function(e){if(!e.origin||e.origin===location.origin){var t=e.data;t&&"videopress_loading_state"===t.event&&"state"in t&&"converting"in t&&("loaded"!==t.state||t.converting||n.props.onVideoLoaded())}},n}return p()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.loadInitializeScript(),window.addEventListener("message",this.receiveMessage,!1)}},{key:"componentWillUnmount",value:function(){Object(E.c)(I,this.onScriptLoaded),this.destroy()}},{key:"componentWillReceiveProps",value:function(e){this.props.isPlaying&&!e.isPlaying?this.pause():!this.props.isPlaying&&e.isPlaying&&this.play()}},{key:"componentDidUpdate",value:function(e){this.props.item.videopress_guid!==e.item.videopress_guid&&(this.destroy(),this.loadInitializeScript())}},{key:"shouldComponentUpdate",value:function(e){return this.props.item.videopress_guid!==e.item.videopress_guid}},{key:"loadInitializeScript",value:function(){Object(E.a)(I,this.onScriptLoaded)}},{key:"destroy",value:function(){if(window.removeEventListener("message",this.receiveMessage),this.player)for(Object(j.invoke)(this,"player.destroy");this.video.firstChild;)this.video.removeChild(this.video.firstChild)}},{key:"play",value:function(){var e=Object(j.get)(this,"player.state");e&&Object(j.invoke)(this,"player.state.play")}},{key:"pause",value:function(){var e=Object(j.get)(this,"player.state");if(e){Object(j.invoke)(this,"player.state.pause");var t=Object(j.invoke)(this,"player.state.videoAt");t&&this.props.onPause(t)}}},{key:"render",value:function(){var e=v()(this.props.className,"is-video");return f.a.createElement("div",{className:e,ref:this.setVideoInstance})}}]),t}(b.Component);C.propTypes={className:h.a.string,isPlaying:h.a.bool,item:h.a.object.isRequired,onPause:h.a.func,onScriptLoadError:h.a.func,onVideoLoaded:h.a.func},C.defaultProps={isPlaying:!1,onPause:j.noop,onScriptLoadError:j.noop,onVideoLoaded:j.noop};var S=C;n.d(t,"a",function(){return O});var O=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){if(Object(y.p)(this.props.item))return f.a.createElement(S,this.props);var e=v()(this.props.className,"is-video");return f.a.createElement("video",{src:Object(y.s)(this.props.item),controls:!0,className:e})}}]),t}(f.a.Component);O.displayName="EditorMediaModalDetailPreviewVideo",O.propTypes={className:h.a.string,item:h.a.object.isRequired}},"./client/post-editor/media-modal/detail/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js"),h=n.n(m),b=n("./node_modules/prop-types/index.js"),f=n.n(b),g=n("./node_modules/i18n-calypso/index.js"),v=n("./node_modules/react/index.js"),y=n.n(v),j=n("./node_modules/react-redux/es/index.js"),_=n("./node_modules/lodash/lodash.js"),x=n("./node_modules/classnames/index.js"),E=n.n(x),k=n("./node_modules/url/url.js"),I=n.n(k),C=n("./node_modules/gridicons/dist/index.js"),S=n.n(C),O=n("./node_modules/@babel/runtime/helpers/defineProperty.js"),N=n.n(O),P=n("./node_modules/react-dom/index.js"),w=n.n(P),M=n("./client/lib/analytics/index.js"),D=n("./client/lib/media/utils.js"),T=n("./client/lib/media/actions.js"),R=n("./client/components/clipboard-button-input/index.jsx"),L=n("./client/components/forms/form-textarea/index.jsx"),A=n("./client/components/forms/form-text-input/index.jsx"),U=n("./client/components/track-input-changes/index.jsx"),V=n("./client/post-editor/media-modal/fieldset.jsx"),F=function(e){function t(){var e;return a()(this,t),e=l()(this,d()(t).apply(this,arguments)),e.bumpTitleStat=function(){M.default.ga.recordEvent("Media","Changed Item Title"),M.default.mc.bumpStat("calypso_media_edit_details","title")},e.bumpAltStat=function(){M.default.ga.recordEvent("Media","Changed Image Alt"),M.default.mc.bumpStat("calypso_media_edit_details","alt")},e.bumpCaptionStat=function(){M.default.ga.recordEvent("Media","Changed Item Caption"),M.default.mc.bumpStat("calypso_media_edit_details","caption")},e.bumpDescriptionStat=function(){M.default.ga.recordEvent("Media","Changed Item Description"),M.default.mc.bumpStat("calypso_media_edit_details","description")},e.setFieldValue=function(t){var n=t.target,s=Object.assign({ID:e.props.item.ID},Object(_.get)(e.state,"modifiedItem",{}),N()({},n.name,n.value));e.setState({modifiedItem:s}),e.persistChange()},e.scrollToShowVisibleDropdown=function(e){e.open&&"scrollIntoView"in window.Element.prototype&&w.a.findDOMNode(e.target).scrollIntoView()},e.persistChange=Object(_.debounce)(e.persistChange,1e3),e}return p()(t,e),r()(t,[{key:"componentWillReceiveProps",value:function(e){this.props.item&&e.item&&e.item.ID!==this.props.item.ID&&(this.setState({modifiedItem:null}),this.persistChange.cancel())}},{key:"isMimePrefix",value:function(e){return Object(D.g)(this.props.item)===e}},{key:"persistChange",value:function(){this.props.site&&this.state.modifiedItem&&T.a.update(this.props.site.ID,this.state.modifiedItem)}},{key:"getItemValue",value:function(e){var t=Object(_.get)(this.state,["modifiedItem",e],null);return null!==t?t:this.props.item?this.props.item[e]:void 0}},{key:"renderImageAltText",value:function(){return this.isMimePrefix("image")?y.a.createElement(V.a,{legend:this.props.translate("Alt text")},y.a.createElement(U.a,{onNewValue:this.bumpAltStat},y.a.createElement(A.a,{name:"alt",value:this.getItemValue("alt"),onChange:this.setFieldValue}))):null}},{key:"render",value:function(){var e=this.props.translate;return y.a.createElement("div",{className:"editor-media-modal-detail__fields"},y.a.createElement(V.a,{legend:e("Title")},y.a.createElement(U.a,{onNewValue:this.bumpTitleStat},y.a.createElement(A.a,{name:"title",value:this.getItemValue("title"),onChange:this.setFieldValue}))),y.a.createElement(V.a,{legend:e("Caption")},y.a.createElement(U.a,{onNewValue:this.bumpCaptionStat},y.a.createElement(L.a,{name:"caption",value:this.getItemValue("caption"),onChange:this.setFieldValue}))),this.renderImageAltText(),y.a.createElement(V.a,{legend:e("Description")},y.a.createElement(U.a,{onNewValue:this.bumpDescriptionStat},y.a.createElement(L.a,{name:"description",value:this.getItemValue("description"),onChange:this.setFieldValue}))),y.a.createElement(V.a,{legend:e("URL")},y.a.createElement(R.a,{value:Object(D.s)(this.props.item)})))}}]),t}(v.Component);F.propTypes={site:f.a.object,item:f.a.object};var q=Object(g.localize)(F),z=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.getItemValue=function(e){var t;if(!n.props.item)return n.props.translate("Loading");switch(e){case"extension":t=(n.props.item[e]||"").toUpperCase();break;case"dimensions":t=[y.a.createElement("abbr",{key:"width",title:n.props.translate("Width in pixels")},n.props.item.width),"  ",y.a.createElement("abbr",{key:"height",title:n.props.translate("Height in pixels")},n.props.item.height)];break;case"date":t=n.props.moment(n.props.item[e]).format("D MMMM YYYY");break;case"length":t=Object(D.q)(n.props.item[e]);break;default:t=n.props.item[e]}return t},n.renderDimensions=function(){if(n.props.item&&(n.props.item.width||n.props.item.height))return y.a.createElement("tr",null,y.a.createElement("th",null,n.props.translate("Dimensions")),y.a.createElement("td",null,n.getItemValue("dimensions")))},n.renderDuration=function(){if(n.props.item&&n.props.item.length)return y.a.createElement("tr",null,y.a.createElement("th",null,n.props.translate("Duration")),y.a.createElement("td",null,n.getItemValue("length")))},n}return p()(t,e),r()(t,[{key:"render",value:function(){var e=E()("editor-media-modal-detail__file-info",{"is-loading":!this.props.item});return y.a.createElement("table",{className:e},y.a.createElement("tbody",null,y.a.createElement("tr",null,y.a.createElement("th",null,this.props.translate("File Name")),y.a.createElement("td",{title:this.getItemValue("file")},y.a.createElement("span",null,this.getItemValue("file")))),y.a.createElement("tr",null,y.a.createElement("th",null,this.props.translate("File Type")),y.a.createElement("td",null,this.getItemValue("extension"))),this.renderDimensions(),this.renderDuration(),y.a.createElement("tr",null,y.a.createElement("th",null,this.props.translate("Upload Date")),y.a.createElement("td",null,this.getItemValue("date")))))}}]),t}(y.a.Component);z.displayName="EditorMediaModalDetailFileInfo",z.propTypes={item:f.a.object};var B=Object(g.localize)(z),W=n("./client/components/image-preloader/index.jsx"),G=n("./client/components/spinner/index.jsx"),H=function(e){function t(e){var n;return a()(this,t),n=l()(this,d()(t).call(this,e)),n.onImagePreloaderLoad=n.onImagePreloaderLoad.bind(h()(h()(n))),n.state={loading:!1},n}return p()(t,e),r()(t,[{key:"componentWillReceiveProps",value:function(e){if(this.props.item.URL===e.item.URL)return null;this.setState({loading:!0})}},{key:"onImagePreloaderLoad",value:function(){this.setState({loading:!1}),this.props.onLoad()}},{key:"render",value:function(){var e=Object(D.s)(this.props.item,{photon:this.props.site&&!this.props.site.is_private}),t=Object(D.k)(this.props.item),n=this.state.loading,s=/^blob/.test(e),a=E()(this.props.className,"is-image",{"is-uploading":t},{"is-loading":n},{"is-blob":s}),i=E()(this.props.className,"is-image","is-fake",{"is-uploading":t},{"is-loading":n},{"is-blob":s});return y.a.createElement("div",null,y.a.createElement("img",{src:e,width:this.props.item.width,height:this.props.item.height,alt:this.props.item.alt||this.props.item.title,className:i}),y.a.createElement(W.a,{src:e,width:this.props.item.width,height:this.props.item.height,onLoad:this.onImagePreloaderLoad,placeholder:y.a.createElement("span",null),alt:this.props.item.alt||this.props.item.title,className:a}),(t||n)&&y.a.createElement(G.a,null))}}]),t}(v.Component);H.propTypes={className:f.a.string,item:f.a.object.isRequired,site:f.a.object},H.defaultProps={onLoad:_.noop};var Y=n("./client/post-editor/media-modal/detail/detail-preview-video.jsx"),K=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){var e=E()(this.props.className,"is-audio");return y.a.createElement("audio",{src:Object(D.s)(this.props.item),controls:!0,className:e})}}]),t}(y.a.Component);K.displayName="EditorMediaModalDetailPreviewAudio",K.propTypes={className:f.a.string,item:f.a.object.isRequired};var Q=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){var e=E()(this.props.className,"is-document");return y.a.createElement("div",{className:e},y.a.createElement(S.a,{icon:"pages",size:120}))}}]),t}(y.a.Component);Q.displayName="EditorMediaModalDetailPreviewDocument",Q.propTypes={className:f.a.string};var Z=n("./client/components/button/index.jsx"),J=n("./client/components/data/query-jetpack-modules/index.jsx"),X=n("./client/lib/version-compare/index.js"),$=n("./client/config/index.js"),ee=n("./client/state/ui/selectors.js"),te=n("./client/state/sites/selectors.js"),ne=n("./client/state/selectors/can-current-user.js"),se=n("./client/state/selectors/is-private-site.js"),ae=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.handleOnRestoreClick=function(){var e=n.props,t=e.site,s=e.item,a=e.onRestore;a(t&&t.ID,s)},n}return p()(t,e),r()(t,[{key:"shouldShowVideoEditingButtons",value:function(e){var t=this.props,n=t.isJetpack,s=t.isVideoPressEnabled,a=t.isVideoPressModuleActive;if(!Object(D.p)(e))return!1;if(n){if(!a)return!1}else if(!s)return!1;return!0}},{key:"shouldShowImageEditingButtons",value:function(e,t){var n=this.props.isSitePrivate;return!!e&&(!!$.a.isEnabled("post-editor/image-editor")&&(!n&&(!Object(_.get)(t,"jetpack",!1)||!Object(X.a)(Object(_.get)(t,"options.jetpack_version","0.0"),"4.7-alpha","<"))))}},{key:"renderEditButton",value:function(){var e=this.props,t=e.item,n=e.onEdit,s=e.translate,a=e.canUserUploadFiles;if(!a)return null;var i=Object(D.g)(t);if(!Object(_.includes)(["image","video"],i))return null;var r=s("video"===i?"Edit Thumbnail":"Edit Image");return y.a.createElement(Z.a,{className:"editor-media-modal-detail__edit",onClick:n,disabled:Object(D.k)(t)},y.a.createElement(S.a,{icon:"pencil",size:36})," ",r)}},{key:"renderRestoreButton",value:function(){var e=this.props,t=e.item,n=e.translate,s=I.a.parse(t.guid),a=I.a.parse(t.URL);return s.pathname!==a.pathname&&y.a.createElement(Z.a,{className:E()("editor-media-modal-detail__restore"),onClick:this.handleOnRestoreClick,disabled:Object(D.k)(t)},y.a.createElement(S.a,{icon:"refresh",size:36}),n("Restore Original"))}},{key:"renderMediaEditorButtons",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"is-desktop";if(!e)return null;var n=Object(D.g)(e);return"video"===n?this.renderVideoEditorButtons(e,t):this.renderImageEditorButtons(t)}},{key:"renderImageEditorButtons",value:function(e){var t=this.props,n=t.item,s=t.site;if(!this.shouldShowImageEditingButtons(n,s))return null;var a=E()("editor-media-modal-detail__edition-bar",e);return y.a.createElement("div",{className:a},this.renderRestoreButton(e),this.renderEditButton())}},{key:"renderVideoEditorButtons",value:function(e,t){if(!this.shouldShowVideoEditingButtons(e))return null;var n=E()("editor-media-modal-detail__edition-bar",t);return y.a.createElement("div",{className:n},this.renderEditButton())}},{key:"renderFields",value:function(){var e=this.props,t=e.site,n=e.item,s=e.canUserUploadFiles;return s?y.a.createElement(q,{site:t,item:n}):null}},{key:"renderPreviousItemButton",value:function(){var e=this.props,t=e.hasPreviousItem,n=e.onShowPreviousItem,s=e.translate;return t?y.a.createElement("button",{onClick:n,className:"editor-media-modal-detail__previous"},y.a.createElement(S.a,{icon:"chevron-left",size:36}),y.a.createElement("span",{className:"screen-reader-text"},s("Previous"))):null}},{key:"renderNextItemButton",value:function(){var e=this.props,t=e.hasNextItem,n=e.onShowNextItem,s=e.translate;return t?y.a.createElement("button",{onClick:n,className:"editor-media-modal-detail__next"},y.a.createElement(S.a,{icon:"chevron-right",size:36}),y.a.createElement("span",{className:"screen-reader-text"},s("Next"))):null}},{key:"renderItem",value:function(){var e=this.props,t=e.item,n=e.site;if(!t)return null;var s,a=Object(D.g)(t);switch(a){case"image":s=H;break;case"video":s=Y.a;break;case"audio":s=K;break;default:s=Q}return y.a.createElement(s,{className:"editor-media-modal-detail__preview",site:n,item:t})}},{key:"render",value:function(){var e=this.props,t=e.isJetpack,n=e.item,s=e.siteId,a=E()("editor-media-modal-detail__item",{"is-loading":!n});return y.a.createElement("figure",{className:a},y.a.createElement("div",{className:"editor-media-modal-detail__content editor-media-modal__content"},y.a.createElement("div",{className:"editor-media-modal-detail__preview-wrapper"},this.renderItem(),this.renderMediaEditorButtons(n),this.renderPreviousItemButton(),this.renderNextItemButton()),y.a.createElement("div",{className:"editor-media-modal-detail__sidebar"},t&&y.a.createElement(J.a,{siteId:s}),this.renderMediaEditorButtons(n,"is-mobile"),this.renderFields(),y.a.createElement(B,{item:n}))))}}]),t}(v.Component);ae.propTypes={site:f.a.object,item:f.a.object,hasPreviousItem:f.a.bool,hasNextItem:f.a.bool,onShowPreviousItem:f.a.func,onShowNextItem:f.a.func,onEdit:f.a.func,onRestore:f.a.func},ae.defaultProps={hasPreviousItem:!1,hasNextItem:!1,onShowPreviousItem:_.noop,onShowNextItem:_.noop,onEdit:_.noop,onRestore:_.noop};var ie=Object(j.b)(function(e){var t=Object(ee.e)(e),n=Object(ne.a)(e,t,"upload_files");return{isJetpack:Object(te.K)(e,t),isVideoPressEnabled:Object(te.s)(e,t,"videopress_enabled"),isVideoPressModuleActive:Object(te.J)(e,t,"videopress"),isSitePrivate:Object(se.a)(e,t),siteId:t,canUserUploadFiles:n}}),re=Object(_.flowRight)(ie,g.localize)(ae),oe=n("./client/components/header-cake/index.jsx"),le=Object(_.memoize)(function(e){(new window.Image).src=e}),ce=n("./client/state/ui/media-modal/constants.js"),de=n("./client/state/ui/editor/actions.js");n.d(t,"a",function(){return pe});var ue=function(e){function t(){var e,n;a()(this,t);for(var s=arguments.length,i=new Array(s),r=0;r<s;r++)i[r]=arguments[r];return n=l()(this,(e=d()(t)).call.apply(e,[this].concat(i))),n.preloadImages=function(){Object(D.d)(n.props.items,"image").forEach(function(e){var t=Object(D.s)(e,{photon:this.props.site&&!this.props.site.is_private});le(t)},h()(h()(n)))},n.incrementIndex=function(e){n.props.onSelectedIndexChange(n.props.selectedIndex+e)},n}return p()(t,e),r()(t,[{key:"componentDidMount",value:function(){this.preloadImages()}},{key:"componentDidUpdate",value:function(){this.preloadImages()}},{key:"render",value:function(){var e=this.props,t=e.items,n=e.selectedIndex,s=e.site,a=e.onEditImageItem,i=e.onEditVideoItem,r=e.onRestoreItem,o=e.onReturnToList,l=t[n],c=Object(D.g)(l);return y.a.createElement("div",{className:"editor-media-modal-detail"},y.a.createElement(oe.a,{onClick:o,backText:this.props.translate("Media Library")}),y.a.createElement(re,{site:s,item:l,hasPreviousItem:n-1>=0,hasNextItem:n+1<t.length,onShowPreviousItem:this.incrementIndex.bind(this,-1),onShowNextItem:this.incrementIndex.bind(this,1),onRestore:r,onEdit:"video"===c?i:a}))}}]),t}(y.a.Component);ue.propTypes={site:f.a.object,items:f.a.array,selectedIndex:f.a.number,onSelectedIndexChange:f.a.func,onReturnToList:f.a.func,onEdit:f.a.func,onRestore:f.a.func},ue.defaultProps={selectedIndex:0,onSelectedIndexChange:_.noop};var pe=Object(g.localize)(ue);t.b=Object(j.b)(null,{onReturnToList:Object(_.partial)(de.l,ce.a.LIST),onEditImageItem:Object(_.partial)(de.l,ce.a.IMAGE_EDITOR),onEditVideoItem:Object(_.partial)(de.l,ce.a.VIDEO_EDITOR)})(pe)},"./client/post-editor/media-modal/fieldset.jsx":function(e,t,n){"use strict";n.d(t,"a",function(){return y});var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),a=n.n(s),i=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(i),o=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),l=n.n(o),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=n.n(c),u=n("./node_modules/@babel/runtime/helpers/inherits.js"),p=n.n(u),m=n("./node_modules/prop-types/index.js"),h=n.n(m),b=n("./node_modules/react/index.js"),f=n.n(b),g=n("./node_modules/classnames/index.js"),v=n.n(g),y=function(e){function t(){return a()(this,t),l()(this,d()(t).apply(this,arguments))}return p()(t,e),r()(t,[{key:"render",value:function(){return f.a.createElement("fieldset",{className:v()("editor-media-modal__fieldset",this.props.className)},f.a.createElement("legend",{className:"editor-media-modal__fieldset-legend"},this.props.legend),this.props.children)}}]),t}(f.a.Component);y.displayName="EditorMediaModalFieldset",y.propTypes={legend:h.a.oneOfType([h.a.string,h.a.element]).isRequired}},"./client/state/sites/media-storage/selectors.js":function(e,t,n){"use strict";function s(e,t){return e.sites.mediaStorage.items[t]}function a(e,t){return!!e.sites.mediaStorage.fetchingItems[t]}n.d(t,"a",function(){return s}),n.d(t,"b",function(){return a})},"./client/state/ui/media-modal/selectors.js":function(e,t,n){"use strict";function s(e){return e.ui.mediaModal.view}n.d(t,"a",function(){return s})}}]);