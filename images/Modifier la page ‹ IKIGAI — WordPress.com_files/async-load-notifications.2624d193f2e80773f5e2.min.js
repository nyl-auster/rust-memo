(window.webpackJsonp=window.webpackJsonp||[]).push([[134],{"./client/notifications/index.jsx":function(e,n,t){"use strict";t.r(n);var i=t("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=t.n(i),s=t("./node_modules/@babel/runtime/helpers/createClass.js"),r=t.n(s),a=t("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=t.n(a),l=t("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),d=t.n(l),u=t("./node_modules/@babel/runtime/helpers/inherits.js"),p=t.n(u),g=t("./node_modules/react/index.js"),v=t.n(g),h=t("./node_modules/classnames/index.js"),m=t.n(h),w=t("./node_modules/page/page.js"),_=t.n(w),f=t("./client/lib/wp/browser.js"),b=t("./client/config/index.js"),k=t("./node_modules/react-redux/es/index.js"),E=t("./client/lib/analytics/index.js"),y=t("./client/state/analytics/actions.js"),j=t("./node_modules/notifications-panel/src/Notifications.jsx"),T=t("./client/state/selectors/get-current-locale-slug.js"),S=t("./node_modules/lodash/lodash.js"),O=t("./client/lib/create-selector/index.js"),I=Object(O.a)(function(e){return Object(S.get)(e,"ui.language.localeVariant",null)},function(e){return e.ui.language}),L=I;t.d(n,"Notifications",function(){return W});var N=function(){return!document||(!document.visibilityState||"visible"===document.visibilityState)},W=function(e){function n(){var e,t;o()(this,n);for(var i=arguments.length,s=new Array(i),r=0;r<i;r++)s[r]=arguments[r];return t=c()(this,(e=d()(n)).call.apply(e,[this].concat(s))),t.state={isVisible:N()},t.handleKeyPress=function(e){e.target!==document.body&&"A"!==e.target.tagName||e.altKey||e.ctrlKey||e.metaKey||(78===e.keyCode&&(e.stopPropagation(),e.preventDefault(),t.props.checkToggle(null,!0)),27===e.keyCode&&t.props.isShowing&&(e.stopPropagation(),e.preventDefault(),t.props.checkToggle(null,!0)))},t.handleVisibilityChange=function(){return t.setState({isVisible:N()})},t.receiveServiceWorkerMessage=function(e){if((!e.origin||e.origin===location.origin)&&"action"in e.data)switch(e.data.action){case"openPanel":return t.props.checkToggle(),t.props.checkToggle(null,!0),Object(j.b)();case"trackClick":return void E.default.tracks.recordEvent("calypso_web_push_notification_clicked",{push_notification_note_id:e.data.notification.note_id,push_notification_type:e.data.notification.type})}},t.postServiceWorkerMessage=function(e){"serviceWorker"in window.navigator&&window.navigator.serviceWorker.ready.then(function(n){return"active"in n&&n.active.postMessage(e)})},t}return p()(n,e),r()(n,[{key:"componentDidMount",value:function(){window.addEventListener("mousedown",this.props.checkToggle),window.addEventListener("touchstart",this.props.checkToggle),window.addEventListener("keydown",this.handleKeyPress),void 0!==document.hidden&&document.addEventListener("visibilitychange",this.handleVisibilityChange),"serviceWorker"in window.navigator&&"addEventListener"in window.navigator.serviceWorker&&(window.navigator.serviceWorker.addEventListener("message",this.receiveServiceWorkerMessage),this.postServiceWorkerMessage({action:"sendQueuedMessages"}))}},{key:"componentWillUnmount",value:function(){window.removeEventListener("mousedown",this.props.checkToggle),window.removeEventListener("touchstart",this.props.checkToggle),window.removeEventListener("keydown",this.handleKeyPress),void 0!==document.hidden&&document.removeEventListener("visibilitychange",this.handleVisibilityChange),"serviceWorker"in window.navigator&&"removeEventListener"in window.navigator.serviceWorker&&window.navigator.serviceWorker.removeEventListener("message",this.receiveServiceWorkerMessage)}},{key:"render",value:function(){var e=this,n=this.props.currentLocaleSlug||Object(b.a)("i18n_default_locale_slug"),t={APP_RENDER_NOTES:[function(n,t){var i=t.newNoteCount;return e.props.setIndicator(i)}],OPEN_LINK:[function(e,n){var t=n.href;return window.open(t,"_blank")}],OPEN_POST:[function(n,t){var i=t.siteId,o=t.postId,s=t.href;b.a.isEnabled("notifications/link-to-reader")?(e.props.checkToggle(),e.props.recordTracksEvent("calypso_notifications_open_post",{site_id:i,post_id:o}),_()("/read/blogs/"+i+"/posts/"+o)):window.open(s,"_blank")}],OPEN_COMMENT:[function(n,t){var i=t.siteId,o=t.postId,s=t.href,r=t.commentId;b.a.isEnabled("notifications/link-to-reader")?(e.props.checkToggle(),e.props.recordTracksEvent("calypso_notifications_open_comment",{site_id:i,post_id:o,comment_id:r}),_()("/read/blogs/"+i+"/posts/"+o+"#comment-"+r)):window.open(s,"_blank")}],OPEN_SITE:[function(n,t){var i=t.siteId,o=t.href;b.a.isEnabled("notifications/link-to-reader")?(e.props.checkToggle(),e.props.recordTracksEvent("calypso_notifications_open_site",{site_id:i}),_()("/read/blogs/"+i)):window.open(o,"_blank")}],VIEW_SETTINGS:[function(){e.props.checkToggle(),_()("/me/notifications")}],EDIT_COMMENT:[function(n,t){var i=t.siteId,o=t.postId,s=t.commentId;e.props.checkToggle(),e.props.recordTracksEvent("calypso_notifications_edit_comment",{site_id:i,post_id:o,comment_id:s}),_()("/comment/"+i+"/"+s+"?action=edit")}]};return v.a.createElement("div",{id:"wpnc-panel",className:m()("wide","wpnc__main",{"wpnt-open":this.props.isShowing,"wpnt-closed":!this.props.isShowing})},v.a.createElement(j.a,{customMiddleware:t,isShowing:this.props.isShowing,isVisible:this.state.isVisible,locale:n,wpcom:f.a}))}}]),n}(g.Component);n.default=Object(k.b)(function(e){return{currentLocaleSlug:L(e)||Object(T.a)(e)}},{recordTracksEvent:y.i})(W)},"./client/state/selectors/get-current-locale-slug.js":function(e,n,t){"use strict";var i=t("./node_modules/lodash/lodash.js"),o=t("./client/lib/create-selector/index.js"),s=Object(o.a)(function(e){return Object(i.get)(e,"ui.language.localeSlug",null)},function(e){return e.ui.language});n.a=s}}]);