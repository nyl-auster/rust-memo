(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{"./client/blocks/term-tree-selector/terms.jsx":function(e,t,r){"use strict";var n=r("./node_modules/@babel/runtime/helpers/objectSpread.js"),s=r.n(n),o=r("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),a=r.n(o),i=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),c=r.n(i),l=r("./node_modules/@babel/runtime/helpers/createClass.js"),u=r.n(l),m=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),d=r.n(m),p=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),h=r.n(p),f=r("./node_modules/@babel/runtime/helpers/inherits.js"),g=r.n(f),b=r("./node_modules/react/index.js"),j=r.n(b),y=r("./node_modules/prop-types/index.js"),v=r.n(y),x=r("./node_modules/react-redux/es/index.js"),_=r("./node_modules/classnames/index.js"),I=r.n(_),O=r("./node_modules/i18n-calypso/index.js"),T=r("./node_modules/react-virtualized/dist/commonjs/AutoSizer/index.js"),R=r.n(T),S=r("./node_modules/react-virtualized/dist/commonjs/List/index.js"),q=r.n(S),E=r("./node_modules/lodash/lodash.js"),C=r("./client/lib/analytics/index.js"),w=function(e){function t(){return c()(this,t),d()(this,h()(t).apply(this,arguments))}return g()(t,e),u()(t,[{key:"render",value:function(){var e,t=this.props.createLink;return t&&(e=this.props.translate("You may want to {{a}}create a new item{{/a}}.",{context:"Term Selector: term search/listing results",comment:"This is used when no terms match the given search, or if there are no terms at all.",components:{a:j.a.createElement("a",{className:"create-link",href:t,target:"_blank",rel:"noopener noreferrer"})}})),j.a.createElement("span",{className:"is-empty-content"},this.props.translate("No results. Please try a different search.")," ",e)}}]),t}(j.a.PureComponent);w.displayName="TermTreeSelectorNoResults",w.propTypes={createLink:v.a.string};var P=Object(O.localize)(w),k=r("./node_modules/gridicons/dist/index.js"),N=r.n(k),H=function(e){function t(){return c()(this,t),d()(this,h()(t).apply(this,arguments))}return g()(t,e),u()(t,[{key:"render",value:function(){return j.a.createElement("div",{className:"term-tree-selector__search"},j.a.createElement(N.a,{icon:"search",size:18}),j.a.createElement("input",{type:"search",placeholder:this.props.translate("Search…",{textOnly:!0}),value:this.props.searchTerm,onChange:this.props.onSearch}))}}]),t}(j.a.Component);H.displayName="TermTreeSelectorSearch",H.propTypes={searchTerm:v.a.string,onSearch:v.a.func.isRequired};var D=Object(O.localize)(H),z=r("./client/lib/formatting/index.js"),M=r("./client/components/data/query-terms/index.jsx"),L=r("./client/state/ui/selectors.js"),U=r("./client/state/terms/selectors.js"),A=r("./client/components/podcast-indicator/index.jsx"),V=r("./client/components/data/query-site-settings/index.js"),W=r("./client/state/selectors/get-podcasting-category-id.js"),F=100,Q=10,J=25,G=function(e){function t(){var e,r;c()(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return r=d()(this,(e=h()(t)).call.apply(e,[this].concat(s))),r.state=r.constructor.initialState,r.recomputeRowHeights=function(){r.list&&(r.list.recomputeRowHeights(),r.isSmall()&&r.forceUpdate())},r.getPageForIndex=function(e){var t=r.props,n=t.query,s=t.lastPage,o=n.number||F,a=Math.ceil(e/o);return Math.max(Math.min(a,s||1/0),1)},r.setRequestedPages=function(e){var t=e.startIndex,n=e.stopIndex,s=r.state.requestedPages,o=Object(E.difference)(Object(E.range)(r.getPageForIndex(t-Q),r.getPageForIndex(n+Q)+1),s);o.length&&r.setState({requestedPages:s.concat(o)})},r.setItemRef=function(e,t){if(t&&e){var n=r.itemHeights[e.ID]||J,s=t.clientHeight;r.itemHeights[e.ID]=s,n!==s&&r.queueRecomputeRowHeights()}},r.hasNoSearchResults=function(){return!r.props.loading&&r.props.terms&&!r.props.terms.length&&!!r.state.searchTerm.length},r.hasNoTerms=function(){return!r.props.loading&&r.props.terms&&!r.props.terms.length},r.getItem=function(e){if(r.props.terms)return r.props.terms[e]},r.isSmall=function(){return!(!r.props.terms||r.state.searchTerm)&&r.props.terms.length<r.props.searchThreshold},r.isRowLoaded=function(e){var t=e.index;return r.props.lastPage||!!r.getItem(t)},r.getTermChildren=function(e){var t=r.props.terms;return Object(E.filter)(t,function(t){var r=t.parent;return r===e})},r.getItemHeight=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?e.parent&&!t&&Object(E.includes)(r.termIds,e.parent)?0:e.ID===r.props.hideTermAndChildren?0:r.itemHeights[e.ID]?r.itemHeights[e.ID]:Object(E.reduce)(r.getTermChildren(e.ID),function(e,t){return e+r.getItemHeight(t,!0)},J):J},r.getRowHeight=function(e){var t=e.index;return r.getItemHeight(r.getItem(t))},r.getCompactContainerHeight=function(){return Object(E.range)(0,r.getRowCount()).reduce(function(e,t){return e+r.getRowHeight({index:t})},0)},r.getRowCount=function(){var e=0;return r.props.terms&&(e+=r.props.terms.length),!r.props.loading&&r.props.terms||(e+=1),e},r.onSearch=function(e){var t=e.target.value;r.state.searchTerm&&!t&&r.props.onSearch(""),t!==r.state.searchTerm&&(r.hasPerformedSearch||(r.hasPerformedSearch=!0,C.default.ga.recordEvent(r.props.analyticsPrefix,"Performed Term Search")),r.setState({searchTerm:t}),r.debouncedSearch())},r.setListRef=function(e){r.list=e},r.renderItem=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if((!e.parent||t||!Object(E.includes)(r.termIds,e.parent))&&e.ID!==r.props.hideTermAndChildren){var n=r.getTermChildren(e.ID),s=r.props,o=s.multiple,a=s.defaultTermId,i=s.translate,c=s.selected,l=s.taxonomy,u=s.podcastingCategoryId,m=e.ID,d="category"===l&&u===m,p=Object(z.b)(e.name)||i("Untitled"),h=Object(E.includes)(c,m),f=o?"checkbox":"radio",g=o&&h&&a&&1===c.length&&a===m,b=j.a.createElement("input",{type:f,value:m,onChange:function(){for(var t,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(t=r.props).onChange.apply(t,[e].concat(s))},disabled:g,checked:h});return j.a.createElement("div",{key:m,ref:function(){for(var t,n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(t=r).setItemRef.apply(t,[e].concat(s))},className:"term-tree-selector__list-item"},j.a.createElement("label",null,b,j.a.createElement("span",{className:"term-tree-selector__label"},p,d&&j.a.createElement(A.a,{size:18}))),n.length>0&&j.a.createElement("div",{className:"term-tree-selector__nested-list"},n.map(function(e){return r.renderItem(e,!0)})))}},r.renderNoResults=function(){if(r.hasNoSearchResults()||r.hasNoTerms())return j.a.createElement("div",{key:"no-results",className:"term-tree-selector__list-item is-empty"},(r.hasNoSearchResults()||!r.props.emptyMessage)&&j.a.createElement(P,{createLink:r.props.createLink}),r.hasNoTerms()&&r.props.emptyMessage)},r.renderRow=function(e){var t=e.index,n=r.getItem(t);return n?r.renderItem(n):j.a.createElement("div",{key:"placeholder",className:"term-tree-selector__list-item is-placeholder"},j.a.createElement("label",null,j.a.createElement("input",{type:r.props.multiple?"checkbox":"radio",disabled:!0,className:"term-tree-selector__input"}),j.a.createElement("span",{className:"term-tree-selector__label"},r.props.translate("Loading…"))))},r.cellRendererWrapper=function(e){var t=e.key,n=e.style,s=a()(e,["key","style"]);return j.a.createElement("div",{key:t,style:n},r.renderRow(s))},r}return g()(t,e),u()(t,[{key:"componentWillMount",value:function(){var e=this;this.itemHeights={},this.hasPerformedSearch=!1,this.list=null,this.termIds=Object(E.map)(this.props.terms,"ID"),this.getTermChildren=Object(E.memoize)(this.getTermChildren),this.queueRecomputeRowHeights=Object(E.debounce)(this.recomputeRowHeights),this.debouncedSearch=Object(E.debounce)(function(){e.props.onSearch(e.state.searchTerm)},500)}},{key:"componentWillReceiveProps",value:function(e){e.taxonomy!==this.props.taxonomy&&this.setState(this.constructor.initialState),this.props.terms!==e.terms&&(this.getTermChildren.cache.clear(),this.termIds=Object(E.map)(e.terms,"ID"))}},{key:"componentDidUpdate",value:function(e){var t=!Object(E.isEqual)(e.selected,this.props.selected)||e.loading&&!this.props.loading||!e.terms&&this.props.terms;t&&this.list.forceUpdateGrid(),this.props.terms!==e.terms&&this.recomputeRowHeights()}},{key:"render",value:function(){var e=this,t=this.getRowCount(),r=this.isSmall(),n=this.state.searchTerm.length,o=(n>0||!r)&&(this.props.terms||!this.props.terms&&n>0),a=this.props,i=a.className,c=a.isError,l=a.loading,u=a.siteId,m=a.taxonomy,d=a.query,p=a.height,h=I()("term-tree-selector",i,{"is-loading":l,"is-small":r,"is-error":c,"is-compact":this.props.compact});return j.a.createElement("div",{className:h},this.state.requestedPages.map(function(e){return j.a.createElement(M.a,{key:"query-"+e,siteId:u,taxonomy:m,query:s()({},d,{page:e})})}),"category"===m&&u&&j.a.createElement(V.a,{siteId:u}),o&&j.a.createElement(D,{searchTerm:this.state.searchTerm,onSearch:this.onSearch}),j.a.createElement(R.a,{disableHeight:!0},function(n){var s=n.width;return j.a.createElement(q.a,{ref:e.setListRef,width:s,height:r?e.getCompactContainerHeight():p,onRowsRendered:e.setRequestedPages,rowCount:t,estimatedRowSize:J,rowHeight:e.getRowHeight,rowRenderer:e.cellRendererWrapper,noRowsRenderer:e.renderNoResults,className:"term-tree-selector__results"})}))}}]),t}(b.Component);G.propTypes={hideTermAndChildren:v.a.number,terms:v.a.array,taxonomy:v.a.string,multiple:v.a.bool,selected:v.a.array,search:v.a.string,siteId:v.a.number,translate:v.a.func,defaultTermId:v.a.number,lastPage:v.a.number,onSearch:v.a.func,onChange:v.a.func,isError:v.a.bool,height:v.a.number},G.defaultProps={analyticsPrefix:"Category Selector",searchThreshold:8,loading:!0,terms:Object.freeze([]),onSearch:function(){},onChange:function(){},onNextPage:function(){},height:300},G.initialState={searchTerm:"",requestedPages:Object.freeze([1])};t.a=Object(x.b)(function(e,t){var r=Object(L.e)(e),n=t.taxonomy,s=t.query,o=t.podcastingCategoryId;return void 0===o&&"category"===n&&(o=Object(W.a)(e,r)),{loading:Object(U.g)(e,r,n,s),terms:Object(U.d)(e,r,n,s),lastPage:Object(U.e)(e,r,n,s),siteId:r,query:s,podcastingCategoryId:o}})(Object(O.localize)(G))},"./client/components/data/query-terms/index.jsx":function(e,t,r){"use strict";var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(n),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),a=r.n(o),i=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(i),l=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),u=r.n(l),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(m),p=r("./node_modules/prop-types/index.js"),h=r.n(p),f=r("./node_modules/react/index.js"),g=r("./node_modules/react-redux/es/index.js"),b=r("./node_modules/react-pure-render/shallowEqual.js"),j=r.n(b),y=r("./client/state/terms/actions.js"),v=r("./client/state/terms/selectors.js"),x=function(e){function t(){return s()(this,t),c()(this,u()(t).apply(this,arguments))}return d()(t,e),a()(t,[{key:"componentWillMount",value:function(){this.request(this.props)}},{key:"componentWillReceiveProps",value:function(e){this.props.siteId===e.siteId&&this.props.taxonomy===e.taxonomy&&j()(this.props.query,e.query)||this.request(e)}},{key:"request",value:function(e){!e.requesting&&e.siteId&&e.requestSiteTerms(e.siteId,e.taxonomy,e.query)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return null}}]),t}(f.Component);x.propTypes={siteId:h.a.number,taxonomy:h.a.string.isRequired,query:h.a.object,requesting:h.a.bool.isRequired,requestSiteTerms:h.a.func.isRequired},x.defaultProps={query:{}},t.a=Object(g.b)(function(e,t){return{requesting:Object(v.f)(e,t.siteId,t.taxonomy,t.query)}},{requestSiteTerms:y.c})(x)},"./client/components/podcast-indicator/index.jsx":function(e,t,r){"use strict";var n=r("./node_modules/@babel/runtime/helpers/classCallCheck.js"),s=r.n(n),o=r("./node_modules/@babel/runtime/helpers/createClass.js"),a=r.n(o),i=r("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),c=r.n(i),l=r("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),u=r.n(l),m=r("./node_modules/@babel/runtime/helpers/inherits.js"),d=r.n(m),p=r("./node_modules/classnames/index.js"),h=r.n(p),f=r("./node_modules/prop-types/index.js"),g=r.n(f),b=r("./node_modules/react/index.js"),j=r.n(b),y=r("./node_modules/i18n-calypso/index.js"),v=r("./node_modules/gridicons/dist/index.js"),x=r.n(v),_=r("./client/components/tooltip/index.jsx"),I=function(e){function t(e){var r;return s()(this,t),r=c()(this,u()(t).call(this,e)),r.showTooltip=function(){r.setState({tooltipVisible:!0})},r.hideTooltip=function(){r.setState({tooltipVisible:!1})},r.setTooltipContext=function(e){r.setState({tooltipContext:e})},r.state={tooltipVisible:!1},r}return d()(t,e),a()(t,[{key:"render",value:function(){var e=this.props,t=e.size,r=e.tooltipType,n=e.translate,s=null;switch(r){case"category":s=n("Posts in this category are included in your Podcast feed");break;case"episode":s=n("Included in your Podcast feed")}var o=h()("podcast-indicator",this.props.className,{"is-compact":this.props.isCompact});return j.a.createElement("span",{className:o},j.a.createElement(x.a,{icon:"microphone",size:t,ref:this.setTooltipContext,onMouseEnter:this.showTooltip,onMouseLeave:this.hideTooltip}),s&&j.a.createElement(_.a,{className:"podcast-indicator__tooltip",context:this.state.tooltipContext,isVisible:this.state.tooltipVisible,position:"bottom left"},s))}}]),t}(j.a.Component);I.propTypes={size:g.a.number,tooltipType:g.a.oneOf(["category","episode",null])},I.defaultProps={size:18,tooltipType:"category"},t.a=Object(y.localize)(I)},"./client/state/terms/actions.js":function(e,t,r){"use strict";r.d(t,"a",function(){return h}),r.d(t,"d",function(){return f}),r.d(t,"b",function(){return g}),r.d(t,"c",function(){return v});var n=r("./node_modules/@babel/runtime/helpers/defineProperty.js"),s=r.n(n),o=r("./node_modules/@babel/runtime/helpers/objectSpread.js"),a=r.n(o),i=r("./node_modules/lodash/lodash.js"),c=r("./client/lib/wp/browser.js"),l=r("./client/state/posts/actions.js"),u=r("./client/state/site-settings/actions.js"),m=r("./client/state/posts/selectors.js"),d=r("./client/state/site-settings/selectors.js"),p=r("./client/state/terms/selectors.js");function h(e,t,r){return function(n){var s=Object(i.uniqueId)("temporary");return n(b(e,t,a()({},r,{ID:s}))),c.a.site(e).taxonomy(t).term().add(r).then(function(r){return n(b(e,t,r)),r},function(){return Promise.resolve()}).then(function(r){return n(y(e,t,s)),r})}}function f(e,t,r,n,o){return function(h,f){return c.a.site(e).taxonomy(t).term(n).update(o).then(function(n){var o=f(),c=Object(i.filter)(Object(p.c)(o,e,t),{parent:r}).map(function(e){return a()({},e,{parent:n.ID})});h(y(e,t,r)),h(j(e,t,c.concat([n])));var g=Object(m.n)(o,e,t,r);g.forEach(function(o){var a=Object(i.filter)(o.terms[t],function(e){return e.ID!==r});a.push(n),h(Object(l.e)(e,o.ID,{terms:s()({},t,a)}))});var b=Object(d.a)(o,e);return"category"===t&&Object(i.get)(b,["default_category"])===r&&n.ID!==r&&h(Object(u.c)(e,{default_category:n.ID})),n})}}function g(e,t,r,n){return function(o,u){return c.a.site(e).taxonomy(t).term(n).delete().then(function(){var n=u(),c=Object(p.b)(n,e,t,r),h=Object(i.get)(c,"post_count",0),f=Object(i.filter)(Object(p.c)(n,e,t),function(e){return e.parent===r}).map(function(e){return a()({},e,{parent:c.parent})});f.length&&o(j(e,t,f));var g=Object(m.n)(n,e,t,r);if(g.forEach(function(n){var a=Object(i.filter)(n.terms[t],function(e){return e.ID!==r});o(Object(l.e)(e,n.ID,{terms:s()({},t,a)}))}),"category"===t&&h>0){var v=Object(d.a)(n,e),x=Object(p.b)(n,e,t,Object(i.get)(v,["default_category"]));x&&o(b(e,t,a()({},x,{post_count:x.post_count+h})))}o(y(e,t,r))})}}function b(e,t,r){return j(e,t,[r])}function j(e,t,r,n,s){return{type:"TERMS_RECEIVE",siteId:e,taxonomy:t,terms:r,query:n,found:s}}function y(e,t,r){return{type:"TERM_REMOVE",siteId:e,taxonomy:t,termId:r}}function v(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function(n){return n({type:"TERMS_REQUEST",siteId:e,taxonomy:t,query:r}),c.a.site(e).taxonomy(t).termsList(r).then(function(s){n({type:"TERMS_REQUEST_SUCCESS",siteId:e,taxonomy:t,query:r}),n(j(e,t,s.terms,r,s.found))}).catch(function(s){n({type:"TERMS_REQUEST_FAILURE",siteId:e,taxonomy:t,query:r,error:s})})}}},"./client/state/terms/selectors.js":function(e,t,r){"use strict";r.d(t,"f",function(){return c}),r.d(t,"g",function(){return l}),r.d(t,"d",function(){return u}),r.d(t,"e",function(){return m}),r.d(t,"c",function(){return d}),r.d(t,"b",function(){return p}),r.d(t,"a",function(){return h});var n=r("./node_modules/@babel/runtime/helpers/objectSpread.js"),s=r.n(n),o=r("./node_modules/lodash/lodash.js"),a=r("./client/lib/create-selector/index.js"),i=r("./client/state/terms/utils.js");function c(e,t,r,n){var s=Object(i.a)(n);return!!Object(o.get)(e.terms.queryRequests,[t,r,s])}function l(e,t,r,n){var a=m(e,t,r,n);return null!==a&&Object(o.range)(1,a+1).some(function(o){var a=s()({},n,{page:o});return c(e,t,r,a)})}Object(a.a)(function(e,t,r,n){var s=Object(o.get)(e.terms.queries,[t,r]);return s?s.getItems(n):null},function(e,t,r){return Object(o.get)(e.terms.queries,[t,r])},function(e,t,r,n){var s=Object(i.a)(n);return[t,r,s].join()});var u=Object(a.a)(function(e,t,r,n){var s=Object(o.get)(e.terms.queries,[t,r]);return s?s.getItemsIgnoringPage(n):null},function(e,t,r){return Object(o.get)(e.terms.queries,[t,r])},function(e,t,r,n){var s=Object(i.b)(n);return[t,r,s].join()});function m(e,t,r,n){var s=Object(o.get)(e.terms.queries,[t,r]);if(!s)return null;var a=s.getNumberOfPages(n);return null===a?null:Math.max(a,1)}function d(e,t,r){var n=Object(o.get)(e.terms.queries,[t,r]);return n?n.getItems():null}function p(e,t,r,n){var s=Object(o.get)(e.terms.queries,[t,r]);if(!s)return null;var a=s.getItem(n);return a||null}function h(e,t,r,n){var s=Object(o.get)(e.terms.queries,[t,r]);return s?s.getFound(n):null}}}]);