(window.webpackJsonp=window.webpackJsonp||[]).push([[88],{"./client/components/data/query-site-settings/index.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(s),a=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(a),i=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),u=n.n(i),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(c),p=n("./node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(p),h=n("./node_modules/react/index.js"),m=n("./node_modules/prop-types/index.js"),f=n.n(m),v=n("./node_modules/react-redux/es/index.js"),y=n("./client/state/site-settings/selectors.js"),g=n("./client/state/site-settings/actions.js"),b=function(e){function t(){return o()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),r()(t,[{key:"componentWillMount",value:function(){this.requestSettings(this.props)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props.siteId;e.siteId&&t!==e.siteId&&this.requestSettings(e)}},{key:"requestSettings",value:function(e){var t=e.requestingSiteSettings,n=e.siteId;!t&&n&&e.requestSiteSettings(n)}},{key:"render",value:function(){return null}}]),t}(h.Component);b.propTypes={siteId:f.a.number,requestingSiteSettings:f.a.bool,requestSiteSettings:f.a.func},t.a=Object(v.b)(function(e,t){var n=t.siteId;return{requestingSiteSettings:Object(y.c)(e,n)}},{requestSiteSettings:g.a})(b)},"./client/components/post-schedule/index.jsx":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/classCallCheck.js"),o=n.n(s),a=n("./node_modules/@babel/runtime/helpers/createClass.js"),r=n.n(a),i=n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js"),u=n.n(i),c=n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js"),l=n.n(c),p=n("./node_modules/@babel/runtime/helpers/inherits.js"),d=n.n(p),h=n("./node_modules/prop-types/index.js"),m=n.n(h),f=n("./node_modules/react/index.js"),v=n.n(f),y=n("./node_modules/i18n-calypso/index.js"),g=n("./node_modules/classnames/index.js"),b=n.n(g),D=n("./node_modules/react-redux/es/index.js"),j=n("./client/components/input-chrono/index.jsx"),_=n("./client/components/date-picker/index.jsx"),C=n("./client/components/data/query-site-settings/index.js"),E=n("./client/components/date-picker/events-tooltip.jsx"),S=n("./client/state/current-user/selectors.js"),T=n("./node_modules/lodash/lodash.js"),O=n("./client/components/segmented-control/item.jsx"),k=n("./client/components/info-popover/index.jsx"),I=n("./client/state/selectors/get-site-setting.js"),w=n("./client/components/segmented-control/index.jsx"),M=n("./client/lib/viewport/index.js"),x=n("./client/components/post-schedule/utils.js"),N=function(e){function t(){var e;return o()(this,t),e=u()(this,l()(t).apply(this,arguments)),e.setTime=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.getTimeValues(),s=Object(y.moment)(e.props.date).set(n);e.props.onChange(s,n)},e.adjustHour=function(t){return e.handleKeyDown(t,"hour")},e.adjustMinute=function(t){return e.handleKeyDown(t,"minute")},e.setAm=function(t){return e.setAmPm(t,"AM")},e.setPm=function(t){return e.setAmPm(t,"PM")},e}return d()(t,e),r()(t,[{key:"handleKeyDown",value:function(e,t){var n=e.keyCode-39,s=this.getTimeValues();if(-1!==n&&1!==n)return null;var o=Number(e.target.value);"hour"===t?(this.props.is12hour&&this.refs.amPmReference&&(o=this.convertTo24Hour(o)),o-=n,o=o>23?0:o,o=o<0?23:o):(o-=n,o=o>59?0:o,o=o<0?59:o),s[t]=o,this.setTime(e,s)}},{key:"getTimeValues",value:function(){var e=this.refs,t=e.amPmReference,n=e.hourReference,s=e.minuteRef,o={},a=Object(x.g)(n.value),r=Object(x.g)(s.value);return!1!==a&&a<24&&(o.hour=Number(a)),this.props.is12hour&&t&&(void 0!==o.hour&&"PM"!==(t.value&&o.hour>12)||(o.hour=Number(n.value.substr(-1))),o.hour=this.convertTo24Hour(o.hour)),!1!==r&&(r>60&&(r=s.value.substr(-1)),o.minute=Number(r)),o}},{key:"setAmPm",value:function(e,t){this.refs.amPmReference.value=t,this.setTime(e)}},{key:"convertTo24Hour",value:function(e){return"PM"===this.refs.amPmReference.value&&e<12?e+=12:"AM"===this.refs.amPmReference.value&&12===e&&(e=0),e}},{key:"renderTimezoneSection",value:function(){var e=this.props,t=e.date,n=e.gmtOffset,s=e.siteId,o=e.siteSlug,a=e.timezone,r=e.translate;if(a||Object(x.f)(n)){var i,u;if(a){var c=t.clone().tz(a);u=c.format("Z"),i=c.utcOffset()-Object(y.moment)(t).utcOffset()}else if(Object(x.f)(n)){var l=t.clone().utcOffset(n);i=l.utcOffset()-Object(y.moment)().utcOffset()}if(i){var p=Object(M.c)()?"top":"right",d=a?a.replace(/\_/gi," ")+" "+u:"UTC"+Object(x.c)(n),h=r("This site timezone (%(timezoneText)s) will be used for publishing. You can change it in {{a}}General Settings{{/a}}.",{args:{timezoneText:d},components:{a:v.a.createElement("a",{href:"/settings/general/"+(o||s)})}});return v.a.createElement("span",null,v.a.createElement("div",{className:"post-schedule__clock-timezone"},r("This site timezone is %(diff)sh from your local timezone.",{args:{diff:Object(x.d)(i)}}),v.a.createElement(k.a,{className:"post-schedule__timezone-info",position:p},h)))}}}},{key:"render",value:function(){var e=this.props,t=e.date,n=e.is12hour,s=e.translate;return v.a.createElement("div",{className:"post-schedule__clock"},v.a.createElement("input",{className:"post-schedule__clock-time",name:"post-schedule__clock_hour",ref:"hourReference",value:t.format(n?"hh":"HH"),onChange:this.setTime,onKeyDown:this.adjustHour,type:"text"}),v.a.createElement("span",{className:"post-schedule__clock-divisor"},":"),v.a.createElement("input",{className:"post-schedule__clock-time",name:"post-schedule__clock_minute",ref:"minuteRef",value:t.format("mm"),onChange:this.setTime,onKeyDown:this.adjustMinute,type:"text"}),n&&v.a.createElement("span",null,v.a.createElement("input",{type:"hidden",ref:"amPmReference",name:"post-schedule__clock_am-pm",value:t.format("A")}),v.a.createElement(w.a,{compact:!0},v.a.createElement(O.a,{value:"am",onClick:this.setAm,selected:"AM"===t.format("A")},s("AM")),v.a.createElement(O.a,{value:"pm",onClick:this.setPm,selected:"PM"===t.format("A")},s("PM")))),this.renderTimezoneSection())}}]),t}(f.Component);N.propTypes={date:m.a.object.isRequired,timezone:m.a.string,gmtOffset:m.a.number,siteId:m.a.number,siteSlug:m.a.string,onChange:m.a.func},N.defaultProps={onChange:T.noop};var P=Object(D.b)(function(e,t){var n=t.siteId;return{is12hour:Object(x.e)(Object(I.a)(e,n,"time_format"))}})(Object(y.localize)(N)),z=n("./node_modules/gridicons/dist/index.js"),A=n.n(z),R=function(e){function t(){return o()(this,t),u()(this,l()(t).apply(this,arguments))}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this;return v.a.createElement("div",{className:"post-schedule__year-controls"},v.a.createElement("button",{className:"post-schedule__year-control-up",onClick:function(){e.props.onYearChange(1)}},v.a.createElement(A.a,{icon:"chevron-up",size:14})),v.a.createElement("button",{className:"post-schedule__year-control-down",onClick:function(){e.props.onYearChange(-1)}},v.a.createElement(A.a,{icon:"chevron-down",size:14})))}}]),t}(v.a.Component);R.displayName="PostScheduleHeaderControls",R.propTypes={onYearChange:m.a.func},R.defaultProps={onYearChange:function(){}};var L=function(e){function t(){var e,n;o()(this,t);for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(a))),n.state={showYearControls:!1},n.setToCurrentMonth=function(){var e=n.props.moment().month();n.props.onDateChange(n.props.date.month(e))},n.setToCurrentYear=function(){var e=n.props.moment().year();n.props.onDateChange(n.props.date.year(e))},n.setYear=function(e){var t=n.props.moment(n.props.date);if(t.year(t.year()+e),0>t.year()||t.year()>9999)return null;n.props.onDateChange(t)},n}return d()(t,e),r()(t,[{key:"render",value:function(){var e=this,t=b()("post-schedule__header",{"is-input-chrono-displayed":this.props.inputChronoDisplayed});return v.a.createElement("div",{className:t},v.a.createElement("span",{className:"post-schedule__header-month",onClick:this.setToCurrentMonth},this.props.date.format("MMM")),v.a.createElement("div",{className:"post-schedule__header-year",onMouseEnter:function(){e.setState({showYearControls:!0})},onMouseLeave:function(){e.setState({showYearControls:!1})}},v.a.createElement("span",{onClick:this.setToCurrentYear},this.props.date.format("YYYY")),this.state.showYearControls&&v.a.createElement(R,{onYearChange:this.setYear})))}}]),t}(v.a.Component);L.displayName="PostScheduleHeader",L.propTypes={date:m.a.object,inputChronoDisplayed:m.a.bool,onDateChange:m.a.func},L.defaultProps={inputChronoDisplayed:!0,onDateChange:function(){}};var Y=Object(y.localize)(L),V=function(){},U=function(e){function t(){var e,n;o()(this,t);for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];return n=u()(this,(e=l()(t)).call.apply(e,[this].concat(a))),n.state={calendarViewDate:Object(y.moment)(n.props.selectedDay?n.props.selectedDay:new Date),tooltipContext:null,showTooltip:!1},n.setCurrentMonth=function(e){e=Object(y.moment)(e),n.props.onMonthChange(e),n.setState({calendarViewDate:e})},n.setViewDate=function(e){n.setState({calendarViewDate:Object(y.moment)(e)})},n.updateDate=function(e){var t=Object(x.a)(e,n.props.timezone,n.props.gmtOffset);n.setState({calendarViewDate:e,isFutureDate:t.isAfter()}),n.props.onDateChange(t)},n.handleOnDayMouseEnter=function(e,t,s,o){var a=n.getEventsFromPosts(n.props.posts);if(!a||!a.length)return n.props.onDayMouseEnter(e,t,s,o);n.setState({eventsByDay:o,tooltipContext:s.target,showTooltip:!0})},n.handleOnDayMouseLeave=function(e,t,s,o){var a=n.getEventsFromPosts(n.props.posts);if(!a||!a.length)return n.props.onDayMouseLeave(e,t,s,o);n.setState({eventsByDay:[],tooltipContext:null,showTooltip:!1})},n}return d()(t,e),r()(t,[{key:"componentWillMount",value:function(){if(!this.props.selectedDay)return this.setState({localizedDate:null,isFutureDate:!1});var e=this.getDateToUserLocation(this.props.selectedDay);this.setState({localizedDate:e,isFutureDate:e.isAfter()})}},{key:"componentWillReceiveProps",value:function(e){if(this.props.selectedDay!==e.selectedDay)return e.selectedDay?void this.setState({localizedDate:this.getDateToUserLocation(e.selectedDay)}):this.setState({localizedDate:null})}},{key:"locale",value:function(){return{formatMonthTitle:function(){}}}},{key:"events",value:function(){return this.props.events.concat(this.getEventsFromPosts(this.props.posts))}},{key:"getEventsFromPosts",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t.map(function(t){var n=e.getDateToUserLocation(t.date);return{id:t.ID,title:t.title,date:n.toDate()}})}},{key:"getDateToUserLocation",value:function(e){return Object(x.b)(e||new Date,this.props.timezone,this.props.gmtOffset)}},{key:"getCurrentDate",value:function(){return Object(y.moment)(this.state.localizedDate||this.getDateToUserLocation())}},{key:"renderInputChrono",value:function(){var e,t=this.getCurrentDate();if(this.state.localizedDate){var n=Object(y.moment)().startOf("day"),s=Object(y.moment)(t).startOf("day"),o=s.diff(n,"days");e=-7<=o&&o<=6?t.calendar():t.format("L LT")}return v.a.createElement("div",{className:"post-schedule__input-chrono"},v.a.createElement(j.a,{value:e,placeholder:t.calendar(),lang:this.props.userLocale,onSet:this.updateDate}),v.a.createElement("hr",{className:"post-schedule__hr"}))}},{key:"renderClock",value:function(){var e=this.state.localizedDate;return e||(e=this.getDateToUserLocation(new Date)),v.a.createElement(P,{date:e,timezone:this.props.timezone,gmtOffset:this.props.gmtOffset,siteId:this.props.site?this.props.site.ID:null,siteSlug:this.props.site?this.props.site.slug:null,onChange:this.updateDate})}},{key:"render",value:function(){var e=!this.props.events||!this.props.events.length,t=b()("post-schedule",{"is-future-date":this.state.isFutureDate});return v.a.createElement("div",{className:t},this.props.site&&v.a.createElement(C.a,{siteId:this.props.site.ID}),v.a.createElement(Y,{date:this.state.calendarViewDate,onDateChange:this.setViewDate,inputChronoDisplayed:this.props.displayInputChrono}),this.props.displayInputChrono&&this.renderInputChrono(),v.a.createElement(_.a,{events:this.events(),locale:this.locale(),disabledDays:this.props.disabledDays,showOutsideDays:this.props.showOutsideDays,modifiers:this.props.modifiers,selectedDay:this.state.localizedDate?this.state.localizedDate.toDate():null,timeReference:this.getCurrentDate(),calendarViewDate:this.state.calendarViewDate.toDate(),onMonthChange:this.setCurrentMonth,onSelectDay:this.updateDate,onDayMouseEnter:this.handleOnDayMouseEnter,onDayMouseLeave:this.handleOnDayMouseLeave}),this.renderClock(),e&&v.a.createElement(E.a,{events:this.state.eventsByDay,context:this.state.tooltipContext,isVisible:this.state.showTooltip}))}}]),t}(f.Component);U.propTypes={events:m.a.array,posts:m.a.array,timezone:m.a.string,gmtOffset:m.a.number,site:m.a.object,displayInputChrono:m.a.bool,onDateChange:m.a.func,onMonthChange:m.a.func,onDayMouseEnter:m.a.func,onDayMouseLeave:m.a.func,userLocale:m.a.string},U.defaultProps={posts:[],events:[],displayInputChrono:!0,onDateChange:V,onMonthChange:V,onDayMouseEnter:V,onDayMouseLeave:V};t.a=Object(D.b)(function(e){return{userLocale:Object(S.h)(e)}})(U)},"./client/components/post-schedule/utils.js":function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"a",function(){return l}),n.d(t,"d",function(){return p}),n.d(t,"c",function(){return d}),n.d(t,"g",function(){return h});var s=n("./node_modules/i18n-calypso/index.js"),o=function(e){return e&&/[gh]|[aA]$/.test(e)},a=function(e){return"number"==typeof e},r=function(e,t,n){return e=Object(s.moment)(e),t?e.tz(t):a(n)&&e.utcOffset(n),e},i=function(e){return Object(s.moment)(e.format?e.format():e)},u=function(e,t,n){var s=i(e),o=r(e,t,n);return s.utcOffset()-o.utcOffset()},c=function(e,t,n){return t||a(n)?i(e).subtract(u(e,t,n),"minute"):Object(s.moment)(e)},l=function(e,t,n){return e=r(e,t,n).add(u(e,t,n),"minute"),!t&&a(n)&&e.utcOffset(n),e},p=function(e){var t=Math.trunc(e/60),n=e>0?"+":"";if(!(e/60%1))return n+String(t);e=Math.abs(e%60);var s=e<10?"0"+e:e;return""+n+t+":"+s},d=function(e){return p(60*e)},h=function(e){return e=String(e),"0"!==e&&"00"!==e&&("0"===e[0]||Number(e)>99)&&(e=Number(e.substr(1))),!(isNaN(Number(e))||Number(e)<0||e.length>2)&&Number(e)}},"./client/state/selectors/get-site-setting.js":function(e,t,n){"use strict";n.d(t,"a",function(){return a});var s=n("./node_modules/lodash/lodash.js"),o=n("./client/state/site-settings/selectors.js");function a(e,t,n){return Object(s.get)(Object(o.a)(e,t),[n],null)}},"./client/state/site-settings/actions.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/objectSpread.js"),o=n.n(s),a=n("./client/lib/wp/browser.js"),r=n("./node_modules/lodash/lodash.js");function i(e){return Object.keys(e).reduce(function(t,n){switch(n){case"default_category":t[n]=parseInt(e[n]);break;case"sharing_show":Object(r.isPlainObject)(e[n])?t[n]=Object(r.values)(e[n]):t[n]=e[n];break;default:t[n]=e[n]}return t},{})}function u(e,t){return{type:"SITE_SETTINGS_UPDATE",siteId:e,settings:t}}function c(e){return function(t){return t({type:"SITE_SETTINGS_REQUEST",siteId:e}),a.a.undocumented().settings(e).then(function(n){var s=n.name,a=n.description,r=n.settings,u=o()({},i(r),{blogname:s,blogdescription:a});t(function(e,t){return{type:"SITE_SETTINGS_RECEIVE",siteId:e,settings:t}}(e,u)),t({type:"SITE_SETTINGS_REQUEST_SUCCESS",siteId:e})}).catch(function(n){t({type:"SITE_SETTINGS_REQUEST_FAILURE",siteId:e,error:n})})}}function l(e,t){return function(n){return n({type:"SITE_SETTINGS_SAVE",siteId:e}),a.a.undocumented().settings(e,"post",t).then(function(t){return n(u(e,i(t.updated))),n({type:"SITE_SETTINGS_SAVE_SUCCESS",siteId:e}),t}).catch(function(t){return n({type:"SITE_SETTINGS_SAVE_FAILURE",siteId:e,error:t}),t})}}n.d(t,"c",function(){return u}),n.d(t,"a",function(){return c}),n.d(t,"b",function(){return l})}}]);